<!DOCTYPE html>



  


<html class="theme-next pisces use-motion" lang="zh-Hans">
<head><meta name="generator" content="Hexo 3.8.0">
  <meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
<meta name="theme-color" content="#222">









<meta http-equiv="Cache-Control" content="no-transform">
<meta http-equiv="Cache-Control" content="no-siteapp">
















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css">







<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css">

<link href="/css/main.css?v=5.1.4" rel="stylesheet" type="text/css">


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png?v=5.1.4">


  <link rel="mask-icon" href="/images/logo.svg?v=5.1.4" color="#222">





  <meta name="keywords" content="Hexo, NexT">





  <link rel="alternate" href="/atom.xml" title="逃梦红尘" type="application/atom+xml">






<meta name="description" content="静，生命之完美；水，生命之本源；流，生命之体现；深，生命之蕴集.">
<meta property="og:type" content="website">
<meta property="og:title" content="逃梦红尘">
<meta property="og:url" content="https://blog.zhaozg.top/index.html">
<meta property="og:site_name" content="逃梦红尘">
<meta property="og:description" content="静，生命之完美；水，生命之本源；流，生命之体现；深，生命之蕴集.">
<meta property="og:locale" content="zh-Hans">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="逃梦红尘">
<meta name="twitter:description" content="静，生命之完美；水，生命之本源；流，生命之体现；深，生命之蕴集.">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Pisces',
    version: '5.1.4',
    sidebar: {"position":"left","display":"post","offset":12,"b2t":false,"scrollpercent":false,"onmobile":false},
    fancybox: true,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    duoshuo: {
      userId: '0',
      author: '博主'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="https://blog.zhaozg.top/">





  <title>逃梦红尘</title>
  








</head>

<body itemscope="" itemtype="http://schema.org/WebPage" lang="zh-Hans">

  
  
    
  

  <div class="container sidebar-position-left 
  page-home">
    <div class="headband"></div>

    <header id="header" class="header" itemscope="" itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/" class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">逃梦红尘</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle">静水流深</p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br>
            
            首页
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br>
            
            标签
          </a>
        </li>
      
        
        <li class="menu-item menu-item-categories">
          <a href="/categories/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-th"></i> <br>
            
            分类
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br>
            
            归档
          </a>
        </li>
      

      
    </ul>
  

  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            
  <section id="posts" class="posts-expand">
    
      

  

  
  
  

  <article class="post post-type-normal" itemscope="" itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://blog.zhaozg.top/2019/01/10/1/">

    <span hidden itemprop="author" itemscope="" itemtype="http://schema.org/Person">
      <meta itemprop="name" content="逃梦">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="逃梦红尘">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/01/10/1/" itemprop="url">从零开始做游戏(二)：我的第一个程序</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2019-01-10T01:15:12+08:00">
                2019-01-10
              </time>
            

            

            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope="" itemtype="http://schema.org/Thing">
                  <a href="/categories/游戏开发/" itemprop="url" rel="index">
                    <span itemprop="name">游戏开发</span>
                  </a>
                </span>

                
                
                  ， 
                
              
                <span itemprop="about" itemscope="" itemtype="http://schema.org/Thing">
                  <a href="/categories/游戏开发/Construct-2/" itemprop="url" rel="index">
                    <span itemprop="name">Construct 2</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <span class="post-meta-item-icon">
                  <i class="fa fa-comment-o"></i>
                </span>
                <a href="/2019/01/10/1/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count valine-comment-count" data-xid="/2019/01/10/1/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          
          

          

          
            <div class="post-wordcount">
              
                
                <span class="post-meta-item-icon">
                  <i class="fa fa-file-word-o"></i>
                </span>
                
                  <span class="post-meta-item-text">字数统计&#58;</span>
                
                <span title="字数统计">
                  738
                </span>
              

              
                <span class="post-meta-divider">|</span>
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-clock-o"></i>
                </span>
                
                  <span class="post-meta-item-text">阅读时长 &asymp;</span>
                
                <span title="阅读时长">
                  2
                </span>
              
            </div>
          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h3 id="从零开始做游戏-二-：我的第一个程序"><a href="#从零开始做游戏-二-：我的第一个程序" class="headerlink" title="从零开始做游戏(二)：我的第一个程序"></a>从零开始做游戏(二)：我的第一个程序</h3><p>—-逃梦</p>
<h2 id="序"><a href="#序" class="headerlink" title="序"></a>序</h2><p>&emsp;&emsp;Construct 2是一款HTML5游戏开发引擎，但是在编程界大部分的第一个程序都是“Hello World”的程序，所以，今天，我们也来用Construct 2来编写我们的第一个“Hello World”程序。但是，在开始编写这个程序之前，让我们先来了解一下Construct 2的界面组成，以便于后续我们知道在什么位置选择什么样的控件，进行什么样的操作。</p>
<h2 id="Construct-2的界面组成"><a href="#Construct-2的界面组成" class="headerlink" title="Construct 2的界面组成"></a>Construct 2的界面组成</h2><p><img src="http://zhaozg.vip/Construct2Sets/C2/Imgs/1547054758550.png" alt="1547054758550"></p>
<p>&emsp;&emsp;Construct 2主要包含了“菜单栏”、布局窗口、项目窗口、图层窗口、对象窗口和属性窗口。</p>
<p>&emsp;&emsp;菜单栏：</p>
<p>&emsp;&emsp;&emsp;&emsp;<img src="http://zhaozg.vip/Construct2Sets/C2/Imgs/1547055069443.png" alt="1547055069443">&emsp;&emsp;该按钮用于预览我们完成的作品。 </p>
<p>&emsp;&emsp;&emsp;&emsp;<img src="http://zhaozg.vip/Construct2Sets/C2/Imgs/1547055152724.png" alt="1547055152724">&emsp;&emsp;该按钮用于在最终作品不能按照预期运行时，用于调试查找问题。 </p>
<p>&emsp;&emsp;&emsp;&emsp;<img src="http://zhaozg.vip/Construct2Sets/C2/Imgs/1547055224910.png" alt="1547055224910">&emsp;&emsp;该按钮用于将我们的作品导出为对应的应用。</p>
<p>&emsp;&emsp;项目窗口：该窗口用于显示我们整个作品中的文件结构及内容。 </p>
<p>​    对象窗口：该窗口用于显示我们添加到作品中的各个控件，编程时我们称其为对象。 </p>
<p>&emsp;&emsp;属性窗口：该窗口用于显示我们添加的控件的属性，我们可以通过调整该窗口中的属性值来改变控件的样式，动作等。</p>
<p>&emsp;&emsp;布局窗口：该窗口是整个作品主要工作的区间。</p>
<p>&emsp;&emsp;图层窗口：每个布局是可以添加多个图层的，比如我们可以放一个背景图层，在背景图层上放一个游戏图层，这样将不同的控件分别放置，以便于我们后续的修改和调整。 </p>
<p>&emsp;&emsp;对于以上内容，需要大家记住，在后面的编程过程中，我们将频繁使用它们。</p>
<p>&emsp;为了让大家容易理解和记忆，我们所有的操作都会尽可能的在上图标注的这几个位置进行，等大家熟练了之后，可以自行去研究其它更快捷、更灵活的操作方式。</p>
<h3 id="我的Hello-World"><a href="#我的Hello-World" class="headerlink" title="我的Hello World"></a>我的Hello World</h3><p>&emsp;&emsp;接下来，我将通过视频来给大家演示如何编写我们的第一个Hello World程序。视频后我将列出关键操作步骤供大家参考。</p>
<video src="http://zhaozg.vip/Construct2Sets/C2/Videos/Video.mp4" controls="controls" style="max-width: 100%; display: block; margin-left: auto; margin-right: auto;"><br>your browser does not support the video tag<br></video>

<p>&emsp;&emsp;在这个示例中，我们主要执行了以下几个步骤：</p>
<ul>
<li>新建空白项目</li>
<li>修改项目名称</li>
<li>修改项目窗口大小</li>
<li>修改布局窗口大小</li>
<li>在布局窗口添加控件 Text</li>
<li>修改Text属性窗口中的 “text” 属性</li>
<li>预览程序</li>
</ul>
<p>&emsp;&emsp;现在，我们已经在Construct 2中写出了我们的第一个程序，接下来，我们将开始我们的游戏，动画之旅。 </p>

          
        
      
    </div>
    
    
    
    
    <div>
		  
		</div>
		
		<div>
      
		</div>

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope="" itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://blog.zhaozg.top/2018/12/21/2/">

    <span hidden itemprop="author" itemscope="" itemtype="http://schema.org/Person">
      <meta itemprop="name" content="逃梦">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="逃梦红尘">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/12/21/2/" itemprop="url">设计原则之总结</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-12-21T00:21:12+08:00">
                2018-12-21
              </time>
            

            

            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope="" itemtype="http://schema.org/Thing">
                  <a href="/categories/设计原则/" itemprop="url" rel="index">
                    <span itemprop="name">设计原则</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <span class="post-meta-item-icon">
                  <i class="fa fa-comment-o"></i>
                </span>
                <a href="/2018/12/21/2/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count valine-comment-count" data-xid="/2018/12/21/2/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          
          

          

          
            <div class="post-wordcount">
              
                
                <span class="post-meta-item-icon">
                  <i class="fa fa-file-word-o"></i>
                </span>
                
                  <span class="post-meta-item-text">字数统计&#58;</span>
                
                <span title="字数统计">
                  72
                </span>
              

              
                <span class="post-meta-divider">|</span>
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-clock-o"></i>
                </span>
                
                  <span class="post-meta-item-text">阅读时长 &asymp;</span>
                
                <span title="阅读时长">
                  1
                </span>
              
            </div>
          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h3 id="设计原则之总结"><a href="#设计原则之总结" class="headerlink" title="设计原则之总结"></a>设计原则之总结</h3><p>—-逃梦</p>
<p>&emsp;&emsp;指导软件设计的六大原则分别是：单一职责原则(SRP)，里氏替换原则(LSP)，依赖倒置原则(DIP)，接口隔离原则(ISP)，迪米特法则(LoD)，开闭原则(OCP)。</p>
<p>&emsp;&emsp;其中，开闭原则</p>

          
        
      
    </div>
    
    
    
    
    <div>
		  
		</div>
		
		<div>
      
		</div>

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope="" itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://blog.zhaozg.top/2018/12/20/2/">

    <span hidden itemprop="author" itemscope="" itemtype="http://schema.org/Person">
      <meta itemprop="name" content="逃梦">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="逃梦红尘">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/12/20/2/" itemprop="url">设计原则之合成复用原则</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-12-20T00:21:12+08:00">
                2018-12-20
              </time>
            

            

            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope="" itemtype="http://schema.org/Thing">
                  <a href="/categories/设计原则/" itemprop="url" rel="index">
                    <span itemprop="name">设计原则</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <span class="post-meta-item-icon">
                  <i class="fa fa-comment-o"></i>
                </span>
                <a href="/2018/12/20/2/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count valine-comment-count" data-xid="/2018/12/20/2/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          
          

          

          
            <div class="post-wordcount">
              
                
                <span class="post-meta-item-icon">
                  <i class="fa fa-file-word-o"></i>
                </span>
                
                  <span class="post-meta-item-text">字数统计&#58;</span>
                
                <span title="字数统计">
                  2.3k
                </span>
              

              
                <span class="post-meta-divider">|</span>
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-clock-o"></i>
                </span>
                
                  <span class="post-meta-item-text">阅读时长 &asymp;</span>
                
                <span title="阅读时长">
                  9
                </span>
              
            </div>
          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h3 id="设计原则之合成复用原则"><a href="#设计原则之合成复用原则" class="headerlink" title="设计原则之合成复用原则"></a>设计原则之合成复用原则</h3><p>—-逃梦</p>
<h2 id="定义"><a href="#定义" class="headerlink" title="定义"></a>定义</h2><p>&emsp;&emsp;合成复用原则 / 组合 - 聚合复用原则。</p>
<p>&emsp;&emsp;英文全称：Composite Reuse Principle / Composition - Aggregate Reuse Principle。</p>
<p>&emsp;&emsp;简称：CRP / CARP</p>
<p>&emsp;&emsp;英文定义：classes should achieve polymorphic behavior and code reuse by their composition (by containing instances of other classes that implement the desired functionality) rather than inheritance from a base or parent class.</p>
<p>&emsp;&emsp;中文解释：在一个新的对象里，通过关联关系(包括组合关系和聚合关系)来使用一些已有的对象作为其中的一部分，新对象通过委派调用已有对象的方法达到复用功能目的。</p>
<p>&emsp;&emsp;概述：在软件复用的时候，尽量先使用组合或者聚合等关联关系来实现，其次再考虑使用继承来实现。</p>
<h2 id="核心思想"><a href="#核心思想" class="headerlink" title="核心思想"></a>核心思想</h2><p>&emsp;&emsp;类的复用常分为 继承复用 和 合成复用两类。继承复用简单、易实现，但是：</p>
<ul>
<li>继承复用破坏了类的封装性。因为继承会将父类的实现细节暴露给子类，父类对子类是透明的，这种复用又称为“白箱”复用。</li>
<li>子类与父类的耦合度高。父类的实现一旦发生任何改变，都会导致子类的实现发生改变，不利于类的扩展和维护。</li>
<li>限制了复用的灵活性。从父类继承而来的实现是静态的，在编译是已被定义好，在运行时不可能发生变化。</li>
</ul>
<p>&emsp;&emsp;所以，在使用继承复用时，一定要严格遵循里氏替换原则。使用组合复用原则，将已有对象纳入新对象中，使之成为新对象的一部分，新对象可以调用已有对象的功能，有以下优点：</p>
<ul>
<li>维持了类的封装性。因为已有对象的内部细节对新对象是不可见的，这种复用又叫“黑箱”复用。</li>
<li>新旧类之间的耦合度低。这种复用所需要的依赖较少，新对象使用已有对象的唯一方法就是通过已有对象提供的接口。</li>
<li>复用灵活度高。这种复用可在运行时动态进行，新对象可以动态引用于已有对象类型相同的对象。</li>
</ul>
<h2 id="好处"><a href="#好处" class="headerlink" title="好处"></a>好处</h2><ul>
<li>维持封装性；</li>
<li>耦合度低；</li>
<li>复用灵活度高；</li>
<li>易扩展；</li>
</ul>
<h2 id="难点"><a href="#难点" class="headerlink" title="难点"></a>难点</h2><p>&emsp;&emsp;如何来界定该使用继承复用还是组合复用？</p>
<h2 id="建议"><a href="#建议" class="headerlink" title="建议"></a>建议</h2><p>&emsp;&emsp;如果两个类之间是“Has-A”的关系，则使用组合复用原则，如果两个类之间是“Is-A”的关系可使用继承复用。“Is-A”是严格的分类学意义上的定义，意思是一个类是另一个类的”一种“；而“Has-A”表示某一个角色具有某一项责任。。</p>
<h2 id="实践"><a href="#实践" class="headerlink" title="实践"></a>实践</h2><p>首先，我们先弄清楚组合、聚合、依赖、关联这些概念。</p>
<p>关于聚合(Aggregation)：</p>
<p>它的定义是：聚合是用来表示“拥有”的关系，是整体与部分的关系，这里的整体和部分都是对象，那么部分有可能会被多个整体共用，而且其生命周期不依赖于整体，也就是说，部分可以离开整体而单独存在。比如，车和车轮，其类图如下：</p>
<p><img src="http://zhaozg.vip/Java/DesignPattern/Images/crp/1547836472579.png" alt="1547836472579"></p>
<p>代码演示如下：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Aggregation</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">		<span class="comment">// TODO Auto-generated method stub</span></span><br><span class="line">		</span><br><span class="line">		Car car=<span class="keyword">new</span> Car(<span class="keyword">new</span> Wheel());</span><br><span class="line">		car.say();</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Car</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">	<span class="comment">//将Wheel作为Car的成员对象来使用</span></span><br><span class="line">	<span class="keyword">private</span> Wheel wheel;</span><br><span class="line">	</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="title">Car</span><span class="params">(Wheel _wheel)</span></span></span><br><span class="line"><span class="function">	</span>&#123;</span><br><span class="line">		<span class="keyword">this</span>.wheel=_wheel;</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">say</span><span class="params">()</span></span></span><br><span class="line"><span class="function">	</span>&#123;</span><br><span class="line">		System.out.println(<span class="string">"我是汽车"</span>);</span><br><span class="line">		wheel.say();</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Wheel</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">say</span><span class="params">()</span></span></span><br><span class="line"><span class="function">	</span>&#123;</span><br><span class="line">		System.out.println(<span class="string">"我是车轮"</span>);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>关于组合(Composition)：</p>
<p>它的定义是：组合是用来表示一种比聚合“强”得多的“拥有”关系。在一个组合关系中，部分和整体的生命周期是一样的。一个组合成的新对象完全拥有对其组成部分的支配权，包括他们的创建和销毁，也就是说部分不能离开整体单独存在。且一个组合关系中的成员对象不能与另一个组合关系共享，一个成员对象在同一时间，只能属于一个组合关系。比如，当蝴蝶还是毛毛虫的时候，它是没有翅膀的，破茧成蝶之后有了翅膀，翅膀作为蝴蝶的一项器官，当蝴蝶死了，翅膀也就不能用了，其类图如下：</p>
<p><img src="http://zhaozg.vip/Java/DesignPattern/Images/crp/1547838091220.png" alt="1547838091220"></p>
<p>代码演示如下：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Composition</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">		<span class="comment">// TODO Auto-generated method stub</span></span><br><span class="line">		ButterFly butterFly=<span class="keyword">new</span> ButterFly();</span><br><span class="line">		butterFly.createButterFly();</span><br><span class="line"></span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Wing</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">	<span class="comment">//长出翅膀</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> Wing <span class="title">createWing</span><span class="params">()</span></span></span><br><span class="line"><span class="function">	</span>&#123;</span><br><span class="line">		System.out.println(<span class="string">"长出翅膀"</span>);</span><br><span class="line">		<span class="keyword">return</span> <span class="keyword">new</span> Wing();</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ButterFly</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">	<span class="keyword">private</span> Wing wing;</span><br><span class="line">	</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="title">ButterFly</span><span class="params">()</span></span></span><br><span class="line"><span class="function">	</span>&#123;</span><br><span class="line">		wing=<span class="keyword">new</span> Wing();</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">createButterFly</span><span class="params">()</span></span></span><br><span class="line"><span class="function">	</span>&#123;</span><br><span class="line">		System.out.println(<span class="string">"生成蝴蝶的时候长出翅膀"</span>);</span><br><span class="line">		wing.createWing();</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>关于依赖(Dependency)：</p>
<p>它的定义是：依赖是类和类之间的连接，表示一个类依赖于另外一个类，它仅仅描述了类和类之间的一种使用和被使用关系，也就是说，一个类的实现，需要依赖另一个类的帮助。具体体现如局部变量、方法的参数、对静态方法的调用，以人与火的关系举例，其类图如下：</p>
<p><img src="http://zhaozg.vip/Java/DesignPattern/Images/crp/1547913805115.png" alt="1547913805115"></p>
<p>代码演示如下：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Dependency</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">		<span class="comment">// TODO Auto-generated method stub</span></span><br><span class="line">		Person person=<span class="keyword">new</span> Person();</span><br><span class="line">		person.cooking(<span class="keyword">new</span> Fire());</span><br><span class="line">		person.cooking2();</span><br><span class="line">		person.cooking3();</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Fire</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">burn</span><span class="params">()</span></span></span><br><span class="line"><span class="function">	</span>&#123;</span><br><span class="line">		System.out.println(<span class="string">"燃烧"</span>);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Person</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line"></span><br><span class="line">	<span class="comment">//作为方法参数</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">cooking</span><span class="params">(Fire fire)</span></span></span><br><span class="line"><span class="function">	</span>&#123;</span><br><span class="line">		fire.burn();</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="comment">//作为成员变量</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">cooking2</span><span class="params">()</span></span></span><br><span class="line"><span class="function">	</span>&#123;</span><br><span class="line">		Fire fire=<span class="keyword">new</span> Fire();</span><br><span class="line">		fire.burn();</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="comment">//静态方法的引用</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">cooking3</span><span class="params">()</span></span></span><br><span class="line"><span class="function">	</span>&#123;</span><br><span class="line">		Fire.burn();</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>关于关联(Association)：</p>
<p>它的定义是：关联是类和类之间的连结(区别于依赖的连接)，关联关系使一个类知道另外一个类的属性和方法。关联可以是双向的，也可以是单向的。具体体现如通过成员变量来实现关联关系，以工程师和计算机的关系举例，其类图如下：</p>
<p><img src="http://zhaozg.vip/Java/DesignPattern/Images/crp/1547914536450.png" alt="1547914536450"></p>
<p>代码演示如下：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Association</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">		<span class="comment">// TODO Auto-generated method stub</span></span><br><span class="line">		Engineer engineer=<span class="keyword">new</span> Engineer(<span class="keyword">new</span> Computer());</span><br><span class="line">		engineer.doSomeThing();</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Computer</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">work</span><span class="params">()</span></span></span><br><span class="line"><span class="function">	</span>&#123;</span><br><span class="line">		System.out.println(<span class="string">"计算机开始工作"</span>);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Engineer</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">	<span class="keyword">private</span> Computer computer;</span><br><span class="line">	</span><br><span class="line">	<span class="comment">//在构造函数中引入</span></span><br><span class="line">	</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="title">Engineer</span><span class="params">(Computer _computer)</span> </span>&#123;</span><br><span class="line">		<span class="comment">// TODO Auto-generated constructor stub</span></span><br><span class="line">		<span class="keyword">this</span>.computer=_computer;</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">doSomeThing</span><span class="params">()</span></span></span><br><span class="line"><span class="function">	</span>&#123;</span><br><span class="line">		computer.work();</span><br><span class="line">		System.out.println(<span class="string">"工程师开始完成一些工作"</span>);</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>接下来，我们通过一个示例来演示继承复用和组合复用的区别。在项目管理过程中，我们常常会有这么几个角色，系统管理员、项目经理、项目成员，扮演这些角色的人员都来自企业的员工，那么考虑这样一种情况，看是否合理。我们定义一个员工类，之后的系统管理员、项目经理、项目成员都从员工类继承而来，然后加上自己特有的属性。其类图如下：</p>
<p><img src="http://zhaozg.vip/Java/DesignPattern/Images/crp/1547915790645.png" alt="1547915790645"></p>
<p>其代码实现如下：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Inherit</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">		<span class="comment">// TODO Auto-generated method stub</span></span><br><span class="line"></span><br><span class="line">		Employee employee;</span><br><span class="line">		</span><br><span class="line">		employee=<span class="keyword">new</span> Employee();</span><br><span class="line">		employee.say();</span><br><span class="line">		</span><br><span class="line">		employee=<span class="keyword">new</span> SystemManager();</span><br><span class="line">		employee.say();</span><br><span class="line">		</span><br><span class="line">		employee=<span class="keyword">new</span> ProjectManager();</span><br><span class="line">		employee.say();</span><br><span class="line">		</span><br><span class="line">		employee=<span class="keyword">new</span> ProjectMember();</span><br><span class="line">		employee.say();</span><br><span class="line">		</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Employee</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">say</span><span class="params">()</span></span></span><br><span class="line"><span class="function">	</span>&#123;</span><br><span class="line">		System.out.println(<span class="string">"我是一个员工"</span>);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">SystemManager</span> <span class="keyword">extends</span> <span class="title">Employee</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">say</span><span class="params">()</span></span></span><br><span class="line"><span class="function">	</span>&#123;</span><br><span class="line">		System.out.println(<span class="string">"我是一个系统管理员"</span>);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ProjectManager</span> <span class="keyword">extends</span> <span class="title">Employee</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">say</span><span class="params">()</span></span></span><br><span class="line"><span class="function">	</span>&#123;</span><br><span class="line">		System.out.println(<span class="string">"我是一个项目经理"</span>);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ProjectMember</span> <span class="keyword">extends</span> <span class="title">Employee</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">say</span><span class="params">()</span></span></span><br><span class="line"><span class="function">	</span>&#123;</span><br><span class="line">		System.out.println(<span class="string">"我是一个项目成员"</span>);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>输出：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">--&gt;我是一个员工</span><br><span class="line">--&gt;我是一个系统管理员</span><br><span class="line">--&gt;我是一个项目经理</span><br><span class="line">--&gt;我是一个项目成员</span><br></pre></td></tr></table></figure>
<p>在这个过程中，我们考虑两个问题：</p>
<p>1、这样的继承操作是否满足里氏替换原则。比如按照LSP，将最后一个employee的表面类型设置为ProjectManager看看是否还能满足里氏替换原则。 这里说明：里氏替换原则是使用继承复用的基础。</p>
<p>2、如果一个员工既是系统管理员、又是项目经理，还是项目成员，那怎么办。</p>
<p>基于以上情况，进行重构，类图如下：</p>
<p><img src="http://zhaozg.vip/Java/DesignPattern/Images/crp/1547917056425.png" alt="1547917056425"></p>
<p>代码实现如下：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Aggregation</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">		<span class="comment">// TODO Auto-generated method stub</span></span><br><span class="line">		</span><br><span class="line">		<span class="keyword">new</span> Employee(<span class="keyword">new</span> SystemManager()).say();</span><br><span class="line">		<span class="keyword">new</span> Employee(<span class="keyword">new</span> ProjectManager()).say();</span><br><span class="line">		<span class="keyword">new</span> Employee(<span class="keyword">new</span> ProjectMember()).say();</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">abstract</span> <span class="class"><span class="keyword">class</span> <span class="title">AbstractRole</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="keyword">void</span> <span class="title">say</span><span class="params">()</span></span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">SystemManager</span> <span class="keyword">extends</span> <span class="title">AbstractRole</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">say</span><span class="params">()</span></span></span><br><span class="line"><span class="function">	</span>&#123;</span><br><span class="line">		System.out.println(<span class="string">"我是一个系统管理员"</span>);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ProjectManager</span> <span class="keyword">extends</span> <span class="title">AbstractRole</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">say</span><span class="params">()</span></span></span><br><span class="line"><span class="function">	</span>&#123;</span><br><span class="line">		System.out.println(<span class="string">"我是一个项目经理"</span>);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ProjectMember</span> <span class="keyword">extends</span> <span class="title">AbstractRole</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">say</span><span class="params">()</span></span></span><br><span class="line"><span class="function">	</span>&#123;</span><br><span class="line">		System.out.println(<span class="string">"我是一个项目成员"</span>);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Employee</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">private</span> AbstractRole abstractRole;</span><br><span class="line">	</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="title">Employee</span><span class="params">(AbstractRole _abstAbstractRole)</span></span></span><br><span class="line"><span class="function">	</span>&#123;</span><br><span class="line">		<span class="keyword">this</span>.abstractRole=_abstAbstractRole;</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">say</span><span class="params">()</span></span></span><br><span class="line"><span class="function">	</span>&#123;</span><br><span class="line">		abstractRole.say();</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>通过这样的方式，增加了角色这个抽象类，然后将员工和抽象类通过聚合的方式创建依赖，完成了员工的角色分配，而且一个员工可以同时拥有多个角色。降低了类之间的耦合度。</p>
<h2 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h2><p>&emsp;&emsp;能用组合复用的情况下就不用继承复用，使用继承复用的前提是需要满足里氏替换原则。</p>

          
        
      
    </div>
    
    
    
    
    <div>
		  
		</div>
		
		<div>
      
		</div>

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope="" itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://blog.zhaozg.top/2018/12/19/2/">

    <span hidden itemprop="author" itemscope="" itemtype="http://schema.org/Person">
      <meta itemprop="name" content="逃梦">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="逃梦红尘">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/12/19/2/" itemprop="url">设计原则之开闭原则</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-12-19T00:21:12+08:00">
                2018-12-19
              </time>
            

            

            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope="" itemtype="http://schema.org/Thing">
                  <a href="/categories/设计原则/" itemprop="url" rel="index">
                    <span itemprop="name">设计原则</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <span class="post-meta-item-icon">
                  <i class="fa fa-comment-o"></i>
                </span>
                <a href="/2018/12/19/2/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count valine-comment-count" data-xid="/2018/12/19/2/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          
          

          

          
            <div class="post-wordcount">
              
                
                <span class="post-meta-item-icon">
                  <i class="fa fa-file-word-o"></i>
                </span>
                
                  <span class="post-meta-item-text">字数统计&#58;</span>
                
                <span title="字数统计">
                  1.9k
                </span>
              

              
                <span class="post-meta-divider">|</span>
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-clock-o"></i>
                </span>
                
                  <span class="post-meta-item-text">阅读时长 &asymp;</span>
                
                <span title="阅读时长">
                  7
                </span>
              
            </div>
          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h3 id="设计原则之开闭原则"><a href="#设计原则之开闭原则" class="headerlink" title="设计原则之开闭原则"></a>设计原则之开闭原则</h3><p>—-逃梦</p>
<h2 id="定义"><a href="#定义" class="headerlink" title="定义"></a>定义</h2><p>&emsp;&emsp;开闭原则。</p>
<p>&emsp;&emsp;英文全称：Open Close Principle。</p>
<p>&emsp;&emsp;简称：OCP</p>
<p>&emsp;&emsp;英文定义：Software entities like classes , modules and functions should be open for extension but closed for modifications.</p>
<p>&emsp;&emsp;中文解释：一个软件实体，如类、模块或函数应该对扩展开放，对修改关闭。</p>
<p>&emsp;&emsp;中文解释：一个软件实体应该通过扩展来实现变化，而不是通过修改已有的代码来实现变化。</p>
<p>&emsp;&emsp;概述：开闭原则是最基础的设计原则，它指导我们如何建立一个稳定、灵活的系统。</p>
<h2 id="核心思想"><a href="#核心思想" class="headerlink" title="核心思想"></a>核心思想</h2><p>&emsp;&emsp;对于变化，优先考虑通过扩展实现。</p>
<h2 id="好处"><a href="#好处" class="headerlink" title="好处"></a>好处</h2><ul>
<li>提高项目稳定性；</li>
<li>提高项目灵活性；</li>
<li>提高代码复用性；</li>
<li>提高可维护性；</li>
</ul>
<h2 id="难点"><a href="#难点" class="headerlink" title="难点"></a>难点</h2><p>&emsp;&emsp;开闭原则是最基础的原则，是单一职责原则、里氏替换原则、依赖倒置原则、接口隔离原则、迪米特法则的基础，但它也是一个原则，没有标准，在实际项目中需要结合实际情况使用。</p>
<h2 id="建议"><a href="#建议" class="headerlink" title="建议"></a>建议</h2><ul>
<li>抽象约束：抽象没有具体实现，有很多可能性，可以跟随需求的变化而变化。<ul>
<li>通过接口或抽象类约束扩展，对扩展进行边界限定，不允许出现在接口或抽象类中不存在的public方法。</li>
<li>参数类型、引用对象尽可能使用接口或抽象类，而不是实现类。</li>
<li>抽象层尽量稳定，一旦确定不允许修改。</li>
</ul>
</li>
<li>通过元数据来控制模块行为，也就是通过配置参数来控制模块行为。</li>
<li>制定项目章程，通过项目章程的约束，比通过接口和抽象类约束的效率更高，扩展性也不会降低。</li>
<li>封装变化。<ul>
<li>将相同的变化封装到一个接口或抽象类中。</li>
<li>将不同的变化封装到不同的接口或抽象类中。</li>
</ul>
</li>
</ul>
<h2 id="实践"><a href="#实践" class="headerlink" title="实践"></a>实践</h2><p>我们上线了一款儿童英语启蒙的应用，其中有一部分是收费单元。针对不同的课程，我们给出了不同的定价，后来在运营过程中又进行了促销活动。以此为例来展示一下开闭原则的应用。</p>
<p>原始类图如下：</p>
<p><img src="http://zhaozg.vip/Java/DesignPattern/Images/ocp/1547572494565.png" alt="1547572494565"></p>
<p>代码实现如下：</p>
<p>ICourse：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">ICourse</span> </span>&#123;</span><br><span class="line">	</span><br><span class="line">	<span class="function"><span class="keyword">public</span> String <span class="title">getCourseName</span><span class="params">()</span></span>;</span><br><span class="line">	</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">getPrice</span><span class="params">()</span></span>;</span><br><span class="line">	</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>Course：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Course</span> <span class="keyword">implements</span> <span class="title">ICourse</span></span>&#123;</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">private</span> String CourseName;</span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">int</span> Price;</span><br><span class="line">	</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="title">Course</span><span class="params">(String _courseName, <span class="keyword">int</span> _price)</span></span></span><br><span class="line"><span class="function">	</span>&#123;</span><br><span class="line">		<span class="keyword">this</span>.CourseName=_courseName;</span><br><span class="line">		<span class="keyword">this</span>.Price=_price;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="meta">@Override</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> String <span class="title">getCourseName</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="comment">// TODO Auto-generated method stub</span></span><br><span class="line">		<span class="keyword">return</span> CourseName;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="meta">@Override</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">getPrice</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="comment">// TODO Auto-generated method stub</span></span><br><span class="line">		<span class="keyword">return</span> Price;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>User：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> java.text.NumberFormat;</span><br><span class="line"><span class="keyword">import</span> java.util.ArrayList;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">User</span> </span>&#123;</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">final</span> <span class="keyword">static</span> ArrayList&lt;ICourse&gt; courseList=<span class="keyword">new</span> ArrayList&lt;ICourse&gt;();</span><br><span class="line">	<span class="keyword">static</span></span><br><span class="line">	&#123;</span><br><span class="line">		courseList.add(<span class="keyword">new</span> Course(<span class="string">"自然拼读"</span>, <span class="number">100000</span>));</span><br><span class="line">		courseList.add(<span class="keyword">new</span> Course(<span class="string">"高频词"</span>, <span class="number">80000</span>));</span><br><span class="line">		courseList.add(<span class="keyword">new</span> Course(<span class="string">"分级阅读"</span>, <span class="number">100000</span>));</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span></span></span><br><span class="line"><span class="function">	</span>&#123;</span><br><span class="line">		NumberFormat numberFormat = NumberFormat.getCurrencyInstance();</span><br><span class="line">		numberFormat.setMaximumFractionDigits(<span class="number">2</span>);</span><br><span class="line">		System.out.println(<span class="string">"用户可以购买如下课程："</span>);</span><br><span class="line">		</span><br><span class="line">		<span class="keyword">for</span>(ICourse course:courseList)</span><br><span class="line">		&#123;</span><br><span class="line">			System.out.println(<span class="string">"课程名称"</span>+course.getCourseName()+<span class="string">"\t课程价格："</span>+numberFormat.format(course.getPrice()/<span class="number">100</span>));</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>输出：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">--&gt;用户可以购买如下课程：</span><br><span class="line">--&gt;课程名称自然拼读	课程价格：￥<span class="number">1</span>,<span class="number">000.00</span></span><br><span class="line">--&gt;课程名称高频词	课程价格：￥<span class="number">800.00</span></span><br><span class="line">--&gt;课程名称分级阅读	课程价格：￥<span class="number">1</span>,<span class="number">000.00</span></span><br></pre></td></tr></table></figure>
<p>后来在促销活动中，提供了折扣价，那么对于这个折扣价的实现，遵循开闭原则的话，其类图如下：</p>
<p><img src="http://zhaozg.vip/Java/DesignPattern/Images/ocp/1547572738658.png" alt="1547572738658"></p>
<p>代码实现如下：</p>
<p>OffCourse:</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">OffCourse</span> <span class="keyword">extends</span> <span class="title">Course</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="title">OffCourse</span><span class="params">(String _courseName, <span class="keyword">int</span> _price)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">super</span>(_courseName, _price);</span><br><span class="line">		<span class="comment">// TODO Auto-generated constructor stub</span></span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="meta">@Override</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">getPrice</span><span class="params">()</span></span></span><br><span class="line"><span class="function">	</span>&#123;</span><br><span class="line">		<span class="keyword">return</span> <span class="keyword">super</span>.getPrice()*<span class="number">80</span>/<span class="number">100</span>;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>修改后的User：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> java.text.NumberFormat;</span><br><span class="line"><span class="keyword">import</span> java.util.ArrayList;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">User</span> </span>&#123;</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">final</span> <span class="keyword">static</span> ArrayList&lt;ICourse&gt; courseList=<span class="keyword">new</span> ArrayList&lt;ICourse&gt;();</span><br><span class="line">	<span class="keyword">static</span></span><br><span class="line">	&#123;</span><br><span class="line">		courseList.add(<span class="keyword">new</span> OffCourse(<span class="string">"自然拼读"</span>, <span class="number">100000</span>));</span><br><span class="line">		courseList.add(<span class="keyword">new</span> OffCourse(<span class="string">"高频词"</span>, <span class="number">80000</span>));</span><br><span class="line">		courseList.add(<span class="keyword">new</span> OffCourse(<span class="string">"分级阅读"</span>, <span class="number">100000</span>));</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span></span></span><br><span class="line"><span class="function">	</span>&#123;</span><br><span class="line">		NumberFormat numberFormat = NumberFormat.getCurrencyInstance();</span><br><span class="line">		numberFormat.setMaximumFractionDigits(<span class="number">2</span>);</span><br><span class="line">		System.out.println(<span class="string">"用户可以购买如下课程："</span>);</span><br><span class="line">		</span><br><span class="line">		<span class="keyword">for</span>(ICourse course:courseList)</span><br><span class="line">		&#123;</span><br><span class="line">			System.out.println(<span class="string">"课程名称"</span>+course.getCourseName()+<span class="string">"\t课程价格："</span>+numberFormat.format(course.getPrice()/<span class="number">100</span>));</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>这样只是简单的通过继承扩展了Course类，覆写了getPrice方法，在User类中将new Course修改成了new OffCourse就满足了变更的要求。</p>
<p>写到这里，我们可以想一下，这个开闭原则用的值不值？如果折扣的逻辑比较复杂，后面的开发又不知道之前的折扣逻辑，每次都重新继承一个Course，对于维护的人来说也是个可怕的事情吧(当然，我们应该重视开发、变更、维护过程中文档知识库的形成)。事实上，在实际生活中，只要是卖产品的，好像都逃不开会有提供折扣的情况，那么我们是不是可以预测提供折扣功能是将来的一个需求变更点呢。如果能预测到这一点，那我们还得考虑有了折扣之后会怎么用呢，站在运营的角度，用户单纯看到原价和单纯看到折扣价其实区别不大，我们应该告诉用户他可以省多少钱。考虑到这样的场景，我们又应该如何来实现这个功能呢。</p>
<p>一种是在一开始设计的时候，就考虑到会使用折扣价，在ICourse接口中加入getOffPrice()，如下：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">ICourse</span> </span>&#123;</span><br><span class="line">	</span><br><span class="line">	<span class="function"><span class="keyword">public</span> String <span class="title">getCourseName</span><span class="params">()</span></span>;</span><br><span class="line">	</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">getPrice</span><span class="params">()</span></span>;</span><br><span class="line">	</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">getOffPrice</span><span class="params">()</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>但是折扣价并不是一直存在的，它往往是针对某次活动有效的，而且这个折扣的计算规则也是变化的。于是考虑将其独立为一个接口，修改后类图如下：</p>
<p><img src="http://zhaozg.vip/Java/DesignPattern/Images/ocp/1547574380216.png" alt="1547574380216"></p>
<p> ICourse， Course的实现与之前一致。增加了IOffCourse接口，并让OffCourse类实现IOffCourse接口。</p>
<p>IOffCourse:</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">IOffCourse</span> <span class="keyword">extends</span> <span class="title">ICourse</span> </span>&#123;</span><br><span class="line">	</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">getOffPrice</span><span class="params">()</span></span>;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>OffCourse：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">OffCourse</span> <span class="keyword">implements</span> <span class="title">IOffCourse</span> </span>&#123;</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">private</span> String Name;</span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">int</span> Price;</span><br><span class="line">	</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="title">OffCourse</span><span class="params">(String _name,<span class="keyword">int</span> _price)</span></span></span><br><span class="line"><span class="function">	</span>&#123;</span><br><span class="line">		<span class="keyword">this</span>.Name=_name;</span><br><span class="line">		<span class="keyword">this</span>.Price=_price;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="meta">@Override</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> String <span class="title">getCourseName</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="comment">// TODO Auto-generated method stub</span></span><br><span class="line">		<span class="keyword">return</span> Name;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="meta">@Override</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">getPrice</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="comment">// TODO Auto-generated method stub</span></span><br><span class="line">		<span class="keyword">return</span> Price;</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="meta">@Override</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">getOffPrice</span><span class="params">()</span></span>&#123;</span><br><span class="line">		<span class="keyword">return</span> Price*<span class="number">80</span>/<span class="number">100</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>在User类中修改如下：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">User</span> </span>&#123;</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">final</span> <span class="keyword">static</span> ArrayList&lt;IOffCourse&gt; courseList=<span class="keyword">new</span> ArrayList&lt;IOffCourse&gt;();</span><br><span class="line">	<span class="keyword">static</span></span><br><span class="line">	&#123;</span><br><span class="line">		courseList.add(<span class="keyword">new</span> OffCourse(<span class="string">"自然拼读"</span>, <span class="number">100000</span>));</span><br><span class="line">		courseList.add(<span class="keyword">new</span> OffCourse(<span class="string">"高频词"</span>, <span class="number">80000</span>));</span><br><span class="line">		courseList.add(<span class="keyword">new</span> OffCourse(<span class="string">"分级阅读"</span>, <span class="number">100000</span>));</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span></span></span><br><span class="line"><span class="function">	</span>&#123;</span><br><span class="line">		NumberFormat numberFormat = NumberFormat.getCurrencyInstance();</span><br><span class="line">		numberFormat.setMaximumFractionDigits(<span class="number">2</span>);</span><br><span class="line">		System.out.println(<span class="string">"用户可以购买如下课程："</span>);</span><br><span class="line">		</span><br><span class="line">		<span class="keyword">for</span>(IOffCourse course:courseList)</span><br><span class="line">		&#123;</span><br><span class="line">			System.out.println(<span class="string">"课程名称"</span>+course.getCourseName()+<span class="string">"\t原价："</span>+numberFormat.format(course.getPrice()/<span class="number">100</span>)+<span class="string">"\t折后价："</span>+numberFormat.format(course.getOffPrice()/<span class="number">100</span>)+<span class="string">"\t为您节省：："</span>+numberFormat.format((course.getPrice()-course.getOffPrice())/<span class="number">100</span>));</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>输出：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">--&gt;用户可以购买如下课程：</span><br><span class="line">--&gt;课程名称自然拼读	原价：￥<span class="number">1</span>,<span class="number">000.00</span>	折后价：￥<span class="number">800.00</span>	为您节省：：￥<span class="number">200.00</span></span><br><span class="line">--&gt;课程名称高频词	原价：￥<span class="number">800.00</span>	折后价：￥<span class="number">640.00</span>	为您节省：：￥<span class="number">160.00</span></span><br><span class="line">--&gt;课程名称分级阅读	原价：￥<span class="number">1</span>,<span class="number">000.00</span>	折后价：￥<span class="number">800.00</span>	为您节省：：￥<span class="number">200.00</span></span><br></pre></td></tr></table></figure>
<p>在项目实施过程中，可能会遇到各种情况，结合自身的经验和项目环境，对项目需求变更风险的预测，这就是开闭原则中的预知变化。</p>
<h2 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h2><p>&emsp;&emsp;开闭原则是最基础的原则，是其他原则的领袖！</p>
<p>&emsp;&emsp;在使用开闭原则时，需要注意的是：</p>
<ul>
<li>开闭原则也只是一个原则，要灵活应用。</li>
<li>项目章程非常重要。</li>
<li>总结经验，预知变化。</li>
</ul>

          
        
      
    </div>
    
    
    
    
    <div>
		  
		</div>
		
		<div>
      
		</div>

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope="" itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://blog.zhaozg.top/2018/12/18/2/">

    <span hidden itemprop="author" itemscope="" itemtype="http://schema.org/Person">
      <meta itemprop="name" content="逃梦">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="逃梦红尘">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/12/18/2/" itemprop="url">设计原则之迪米特法则</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-12-18T00:21:12+08:00">
                2018-12-18
              </time>
            

            

            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope="" itemtype="http://schema.org/Thing">
                  <a href="/categories/设计原则/" itemprop="url" rel="index">
                    <span itemprop="name">设计原则</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <span class="post-meta-item-icon">
                  <i class="fa fa-comment-o"></i>
                </span>
                <a href="/2018/12/18/2/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count valine-comment-count" data-xid="/2018/12/18/2/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          
          

          

          
            <div class="post-wordcount">
              
                
                <span class="post-meta-item-icon">
                  <i class="fa fa-file-word-o"></i>
                </span>
                
                  <span class="post-meta-item-text">字数统计&#58;</span>
                
                <span title="字数统计">
                  1.8k
                </span>
              

              
                <span class="post-meta-divider">|</span>
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-clock-o"></i>
                </span>
                
                  <span class="post-meta-item-text">阅读时长 &asymp;</span>
                
                <span title="阅读时长">
                  7
                </span>
              
            </div>
          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h3 id="设计原则之迪米特法则"><a href="#设计原则之迪米特法则" class="headerlink" title="设计原则之迪米特法则"></a>设计原则之迪米特法则</h3><p>—-逃梦</p>
<h2 id="定义"><a href="#定义" class="headerlink" title="定义"></a>定义</h2><p>&emsp;&emsp;迪米特法则/最少知识原则。</p>
<p>&emsp;&emsp;英文全称：Law of Demeter / Least Knowledge Principle。</p>
<p>&emsp;&emsp;简称：LoD / LKP</p>
<p>&emsp;&emsp;英文定义1：Only talk to your immediate friends.</p>
<p>&emsp;&emsp;中文解释1：一个对象应该对其他对象有最少的了解。</p>
<p>&emsp;&emsp;中文解释2：只与直接的朋友进行通信。</p>
<p>&emsp;&emsp;概述：一个类应该对自己需要耦合或调用的类知道的最少，只关心提供给我的方法，其他的不关心。</p>
<h2 id="核心思想"><a href="#核心思想" class="headerlink" title="核心思想"></a>核心思想</h2><p>&emsp;&emsp;迪米特法则的核心思想就是类间解耦。。</p>
<h2 id="好处"><a href="#好处" class="headerlink" title="好处"></a>好处</h2><ul>
<li>降低耦合度；</li>
<li>提高代码复用率；</li>
<li>提高系统健壮性；</li>
<li>预防变更扩散；</li>
</ul>
<h2 id="难点"><a href="#难点" class="headerlink" title="难点"></a>难点</h2><p>&emsp;&emsp;迪米特法则的难点在于解耦的程序，解耦不足，违背迪米特法则，但是过分解耦，会产生大量的中转或跳转类，导致系统复杂性提高，维护难度增加。</p>
<h2 id="建议"><a href="#建议" class="headerlink" title="建议"></a>建议</h2><ul>
<li>只与最直接相关的类产生依赖。</li>
<li>一个方法尽量不引入一个类中不存在的对象。</li>
<li>从被依赖者角度来说，只暴露应该暴露的方法和属性，少公布public方法和非静态的public变量，多用private , package-private , protected等访问权限。</li>
<li>在定义方法的时候，如果该方法既不会增加类间的关系，也不会对本类产生负面影响，就放置在本类中。</li>
<li>谨慎使用Serializable。</li>
<li>针对不同的项目、产品、业务环境及经验、常识灵活应用，原则是死的，人是活的。</li>
</ul>
<h2 id="实践"><a href="#实践" class="headerlink" title="实践"></a>实践</h2><p>最近变得越来越懒了，为了保持房间的干净，体验了一把智能扫地机器人。以命令扫地机人打扫房间为例。</p>
<p>先设计了如下的类图：</p>
<p><img src="http://zhaozg.vip/Java/DesignPattern/Images/lod/1547473882016.png" alt="1547473882016"></p>
<p>代码实现如下：</p>
<p>Room：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Room</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">private</span> String RoomName;</span><br><span class="line">	</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="title">Room</span><span class="params">(String _roomName)</span></span></span><br><span class="line"><span class="function">	</span>&#123;</span><br><span class="line">		<span class="keyword">this</span>.RoomName=_roomName;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> String <span class="title">getRoomName</span><span class="params">()</span></span></span><br><span class="line"><span class="function">	</span>&#123;</span><br><span class="line">		<span class="keyword">return</span> RoomName;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>Robot：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Robot</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">clean</span><span class="params">(Room room)</span></span></span><br><span class="line"><span class="function">	</span>&#123;</span><br><span class="line">		System.out.println(<span class="string">"清扫"</span>+room.getRoomName());</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>Person：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"><span class="keyword">import</span> java.util.ArrayList;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Person</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">cleanCommand</span><span class="params">(Robot robot)</span></span></span><br><span class="line"><span class="function">	</span>&#123;</span><br><span class="line">		<span class="comment">//主人告诉机器人要清扫哪些房间</span></span><br><span class="line">        List&lt;Room&gt; listRooms=<span class="keyword">new</span> ArrayList();</span><br><span class="line">		listRooms.add(<span class="keyword">new</span> Room(<span class="string">"客厅"</span>));</span><br><span class="line">		listRooms.add(<span class="keyword">new</span> Room(<span class="string">"厨房"</span>));</span><br><span class="line">		listRooms.add(<span class="keyword">new</span> Room(<span class="string">"卧室"</span>));</span><br><span class="line">		listRooms.add(<span class="keyword">new</span> Room(<span class="string">"卫生间"</span>));</span><br><span class="line">		</span><br><span class="line">		<span class="keyword">for</span>(Room room:listRooms)</span><br><span class="line">		&#123;</span><br><span class="line">			<span class="comment">//机器人清扫</span></span><br><span class="line">            robot.clean(room);</span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>Client：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Client</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">		<span class="comment">// TODO Auto-generated method stub</span></span><br><span class="line">		<span class="comment">//实例化一个主人</span></span><br><span class="line">		Person person=<span class="keyword">new</span> Person();</span><br><span class="line">		<span class="comment">//给机器下达命令</span></span><br><span class="line">		person.cleanCommand(<span class="keyword">new</span> Robot());</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>运行结果：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">--&gt;清扫客厅</span><br><span class="line">--&gt;清扫厨房</span><br><span class="line">--&gt;清扫卧室</span><br><span class="line">--&gt;清扫卫生间</span><br></pre></td></tr></table></figure>
<p>基于迪米特法则，朋友类是指：出现在成员变量，方法的输入输出参数中的类。我们观察一下Person类中对Room类的依赖，Room既不是Person的成员变量，也不是Person中方法的输入输出参数。Room就不是Person的直接朋友，我们对上面的方法进行重构，类图如下：</p>
<p><img src="http://zhaozg.vip/Java/DesignPattern/Images/lod/1547475281828.png" alt="1547475281828"></p>
<p>代码实现如下：</p>
<p>Room:</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Room</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">private</span> String RoomName;</span><br><span class="line">	</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="title">Room</span><span class="params">(String _roomName)</span></span></span><br><span class="line"><span class="function">	</span>&#123;</span><br><span class="line">		<span class="keyword">this</span>.RoomName=_roomName;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> String <span class="title">getRoomName</span><span class="params">()</span></span></span><br><span class="line"><span class="function">	</span>&#123;</span><br><span class="line">		<span class="keyword">return</span> RoomName;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>Robot：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Robot</span> </span>&#123;</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">private</span> Room room;</span><br><span class="line">	</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="title">Robot</span><span class="params">(Room _room)</span></span></span><br><span class="line"><span class="function">	</span>&#123;</span><br><span class="line">		<span class="keyword">this</span>.room=_room;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">clean</span><span class="params">()</span></span></span><br><span class="line"><span class="function">	</span>&#123;</span><br><span class="line">		System.out.println(<span class="string">"清扫"</span>+room.getRoomName());</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>Person：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Person</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">cleanCommand</span><span class="params">(Robot robot)</span></span></span><br><span class="line"><span class="function">	</span>&#123;</span><br><span class="line">		robot.clean();</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>Client：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> java.util.ArrayList;</span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Client</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">		<span class="comment">// TODO Auto-generated method stub</span></span><br><span class="line">		<span class="comment">//今天我要打扫房间，列好房间清单</span></span><br><span class="line">		List&lt;Room&gt; listRooms=<span class="keyword">new</span> ArrayList&lt;Room&gt;();</span><br><span class="line">		listRooms.add(<span class="keyword">new</span> Room(<span class="string">"客厅"</span>));</span><br><span class="line">		listRooms.add(<span class="keyword">new</span> Room(<span class="string">"厨房"</span>));</span><br><span class="line">		listRooms.add(<span class="keyword">new</span> Room(<span class="string">"卧室"</span>));</span><br><span class="line">		listRooms.add(<span class="keyword">new</span> Room(<span class="string">"卫生间"</span>));</span><br><span class="line">		</span><br><span class="line">		<span class="comment">//实例化一个主人</span></span><br><span class="line">		Person person=<span class="keyword">new</span> Person();</span><br><span class="line">		</span><br><span class="line">		<span class="keyword">for</span>(Room room:listRooms)</span><br><span class="line">		&#123;</span><br><span class="line">			<span class="comment">//给机器下达命令</span></span><br><span class="line">			person.cleanCommand(<span class="keyword">new</span> Robot(room));</span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">	&#125;</span><br></pre></td></tr></table></figure>
<p>这样修改后，Person类只与Robot类进行交流，断开了对Room类的依赖，降低了耦合，提供了系统健壮性。当然，生活中实际的情况要复杂多了，用扫地机器人也不是一个按钮按下去就可以去喝茶了，我们家的机器人就经常会发出“陛下，臣妾被卡住了”，或者“陛下，臣妾吃了不干净的东西”，甚至,”陛下，臣妾找不到回家的路了”。我还得屁颠屁颠把它抱回去。想来这也是没办法的事情，谁叫咱房间乱来着。</p>
<p>现在我和我的机器人是朋友了，但是迪米特法则说朋友之间也是有距离的。咱再来说说这个距离，我还是很懒，希望一个按钮按下去就万事OK了，那么机器人在我按下按钮后会有哪些步骤呢，这里简化一下，它需要启动服务，规划路径，清扫，停止服务，回充。</p>
<p>我和机器人的类图如下：</p>
<p><img src="http://zhaozg.vip/Java/DesignPattern/Images/lod/1547476942516.png" alt="1547476942516"></p>
<p>Robot代码：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Robot</span> </span>&#123;</span><br><span class="line">	</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">startService</span><span class="params">()</span></span>&#123;</span><br><span class="line">		System.out.println(<span class="string">"启动服务"</span>);</span><br><span class="line">		<span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">findPath</span><span class="params">()</span></span>&#123;</span><br><span class="line">		System.out.println(<span class="string">"路径规划"</span>);</span><br><span class="line">		<span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">clean</span><span class="params">()</span></span>&#123;</span><br><span class="line">		System.out.println(<span class="string">"清扫"</span>);</span><br><span class="line">		<span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">stopService</span><span class="params">()</span></span>&#123;</span><br><span class="line">		System.out.println(<span class="string">"停止服务"</span>);</span><br><span class="line">		<span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">goBack</span><span class="params">()</span></span>&#123;</span><br><span class="line">		System.out.println(<span class="string">"回充"</span>);</span><br><span class="line">		<span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>如果机器人给我提供的方法是这样的，那么我需要在我的类里面按序调用这些方法，这不符合最少知识原则，我根本不想关心机器人的这个过程是什么样的。而且，按照原则，被依赖对象应该只暴露需要暴露的方法。于是，我们在Robot中增加一个对外公布的方法，其他流程都私有化。</p>
<p>代码如下：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Robot</span> </span>&#123;</span><br><span class="line">	</span><br><span class="line">	<span class="function"><span class="keyword">private</span> <span class="keyword">int</span> <span class="title">startService</span><span class="params">()</span></span>&#123;</span><br><span class="line">		System.out.println(<span class="string">"启动服务"</span>);</span><br><span class="line">		<span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="function"><span class="keyword">private</span> <span class="keyword">int</span> <span class="title">findPath</span><span class="params">()</span></span>&#123;</span><br><span class="line">		System.out.println(<span class="string">"路径规划"</span>);</span><br><span class="line">		<span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="function"><span class="keyword">private</span> <span class="keyword">int</span> <span class="title">clean</span><span class="params">()</span></span>&#123;</span><br><span class="line">		System.out.println(<span class="string">"清扫"</span>);</span><br><span class="line">		<span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="function"><span class="keyword">private</span> <span class="keyword">int</span> <span class="title">stopService</span><span class="params">()</span></span>&#123;</span><br><span class="line">		System.out.println(<span class="string">"停止服务"</span>);</span><br><span class="line">		<span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="function"><span class="keyword">private</span> <span class="keyword">int</span> <span class="title">goBack</span><span class="params">()</span></span>&#123;</span><br><span class="line">		System.out.println(<span class="string">"回充"</span>);</span><br><span class="line">		<span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">execute</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		startService();</span><br><span class="line">		findPath();</span><br><span class="line">		clean();</span><br><span class="line">		stopService();</span><br><span class="line">		goBack();</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>此时，Person只需要调用这个public方法即可，代码如下：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Person</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">cleanCommand</span><span class="params">(Robot robot)</span></span></span><br><span class="line"><span class="function">	</span>&#123;</span><br><span class="line">		robot.execute();</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>这样一来，就符合最少知识原则了，我对它知道的很少，只需要按一下按钮即可，多么轻松惬意！</p>
<h2 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h2><p>&emsp;&emsp;迪米特法则主要就是用来在类间解耦，在使用过程中，可以做如下考虑：</p>
<ul>
<li>在类的划分上，应当尽量创建松耦合的类，类之间的耦合度越低，就越有利于复用，一个处在松耦合中的类一旦被修改，不会对关联的类造成太大波及；</li>
<li>在类的结构设计上，每一个类都应当尽量降低其成员变量和成员函数的访问权限；</li>
<li>在类的设计上，只要有可能，一个类型应当设计成不变类；</li>
<li>在对其他类的引用上，一个对象对其他对象的引用应当降到最低。</li>
<li>避免过滤解耦，当跳转次数越多，导致系统过分冗余，且开发人员可能无法正确理解业务流程。</li>
</ul>

          
        
      
    </div>
    
    
    
    
    <div>
		  
		</div>
		
		<div>
      
		</div>

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope="" itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://blog.zhaozg.top/2018/12/17/2/">

    <span hidden itemprop="author" itemscope="" itemtype="http://schema.org/Person">
      <meta itemprop="name" content="逃梦">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="逃梦红尘">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/12/17/2/" itemprop="url">设计原则之接口隔离</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-12-17T00:21:12+08:00">
                2018-12-17
              </time>
            

            

            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope="" itemtype="http://schema.org/Thing">
                  <a href="/categories/设计原则/" itemprop="url" rel="index">
                    <span itemprop="name">设计原则</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <span class="post-meta-item-icon">
                  <i class="fa fa-comment-o"></i>
                </span>
                <a href="/2018/12/17/2/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count valine-comment-count" data-xid="/2018/12/17/2/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          
          

          

          
            <div class="post-wordcount">
              
                
                <span class="post-meta-item-icon">
                  <i class="fa fa-file-word-o"></i>
                </span>
                
                  <span class="post-meta-item-text">字数统计&#58;</span>
                
                <span title="字数统计">
                  1.4k
                </span>
              

              
                <span class="post-meta-divider">|</span>
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-clock-o"></i>
                </span>
                
                  <span class="post-meta-item-text">阅读时长 &asymp;</span>
                
                <span title="阅读时长">
                  5
                </span>
              
            </div>
          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h3 id="设计原则之接口隔离"><a href="#设计原则之接口隔离" class="headerlink" title="设计原则之接口隔离"></a>设计原则之接口隔离</h3><p>—-逃梦</p>
<h2 id="定义"><a href="#定义" class="headerlink" title="定义"></a>定义</h2><p>&emsp;&emsp;接口隔离原则。</p>
<p>&emsp;&emsp;英文全称：Interface Segregation Principle。</p>
<p>&emsp;&emsp;简称：ISP</p>
<p>&emsp;&emsp;英文定义1：Clients should not be forced to depend upon interface that they don’t user.</p>
<p>&emsp;&emsp;中文解释1：客户端不应该依赖它不需要的接口。</p>
<p>&emsp;&emsp;英文定义2：The dependency of one class to another one should depend on the smallest possible interface.</p>
<p>&emsp;&emsp;中文解释2：类之间的依赖关系应该建立在最小的接口上。</p>
<p>&emsp;&emsp;概述：建立单一接口，不要建立臃肿庞大的接口，接口尽量细化，同时接口中的方法尽量少。</p>
<h2 id="核心思想"><a href="#核心思想" class="headerlink" title="核心思想"></a>核心思想</h2><p>&emsp;&emsp;接口中的方法尽可能少,接口尽可能小。</p>
<h2 id="好处"><a href="#好处" class="headerlink" title="好处"></a>好处</h2><ul>
<li>提高系统灵活性；</li>
<li>提供系统可维护性；</li>
<li>预防未来变更的扩散；</li>
</ul>
<h2 id="难点"><a href="#难点" class="headerlink" title="难点"></a>难点</h2><ul>
<li>接口隔离粒度的把控。接口设计的粒度越小，系统就越灵活，但同时也会带来结构的复杂化，开发难度增加，可维护性降低。此时需要依据实际业务情况、项目情况、经验、常识来进行判断。</li>
</ul>
<h2 id="建议"><a href="#建议" class="headerlink" title="建议"></a>建议</h2><ul>
<li>接口尽量小，一个接口只服务于一个子模块或业务逻辑，但是有限度，要尽可能满足单一职责原则。</li>
<li>接口高内聚，即对外公布的public方法尽可能少。</li>
<li>定制服务，即针对不同的业务功能，提供定制的接口服务，只提供客户端需要的方法。</li>
<li>已污染接口，尽量去修改，如果修改风险更大，考虑适配器模式进行转化。</li>
<li>针对不同的项目、产品、业务环境及经验、常识灵活应用，原则是死的，人是活的。</li>
</ul>
<h2 id="实践"><a href="#实践" class="headerlink" title="实践"></a>实践</h2><p>公司需要招工程师，起初的时候希望招一个会数据库、会Java开发的，(当然实际情况中要求会更多)，于是写了一份JD，里面详细罗列了应聘人员需要具备的技能要求。面试官在面试的时候需要检查求职者是否具备这些要求。描述这样一个场景，其类图如下：</p>
<p><img src="http://zhaozg.vip/Java/DesignPattern/Images/isp/1547395479307.png" alt="1547395479307"></p>
<p>代码实现如下：</p>
<p>ICandidate：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">ICandidate</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">	<span class="comment">//要求具备java开发能力</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">javaAbility</span><span class="params">()</span></span>;</span><br><span class="line">	<span class="comment">//要求具备数据库开发能力</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">databaseAbility</span><span class="params">()</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>AbstractInterviewer：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="class"><span class="keyword">class</span> <span class="title">AbstractInterviewer</span> </span>&#123;</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">protected</span> ICandidate candidate;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="title">AbstractInterviewer</span><span class="params">(ICandidate _candidate)</span></span></span><br><span class="line"><span class="function">	</span>&#123;</span><br><span class="line">		<span class="keyword">this</span>.candidate=_candidate;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="comment">//面试</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="keyword">void</span> <span class="title">interview</span><span class="params">()</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>Candidate：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Candidate</span> <span class="keyword">implements</span> <span class="title">ICandidate</span></span>&#123;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">private</span> String candidateName;</span><br><span class="line">	</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="title">Candidate</span><span class="params">(String _candidateName)</span></span></span><br><span class="line"><span class="function">	</span>&#123;</span><br><span class="line">		<span class="keyword">this</span>.candidateName=_candidateName;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="meta">@Override</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">javaAbility</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="comment">// TODO Auto-generated method stub</span></span><br><span class="line">		System.out.println(<span class="string">"我是"</span>+candidateName+<span class="string">"我是高手，我会java"</span>);</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="meta">@Override</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">databaseAbility</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="comment">// TODO Auto-generated method stub</span></span><br><span class="line">		System.out.println(<span class="string">"我是"</span>+candidateName+<span class="string">"我是高手，我会数据库"</span>);</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>Interviewer：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Interviewer</span> <span class="keyword">extends</span> <span class="title">AbstractInterviewer</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="title">Interviewer</span><span class="params">(ICandidate _candidate)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">super</span>(_candidate);</span><br><span class="line">		<span class="comment">// TODO Auto-generated constructor stub</span></span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="meta">@Override</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">interview</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="comment">// TODO Auto-generated method stub</span></span><br><span class="line">		<span class="comment">//面试java能力</span></span><br><span class="line">		candidate.javaAbility();</span><br><span class="line">		<span class="comment">//面试数据库能力</span></span><br><span class="line">		candidate.databaseAbility();</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>Client：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Client</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">		<span class="comment">// TODO Auto-generated method stub</span></span><br><span class="line">		<span class="comment">//来了一个面试者张三</span></span><br><span class="line">		ICandidate candidate= <span class="keyword">new</span> Candidate(<span class="string">"张三"</span>);</span><br><span class="line">		AbstractInterviewer interviewer = <span class="keyword">new</span> Interviewer(candidate);</span><br><span class="line">		interviewer.interview();</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>如果只是这样，这样实现也是可以的，但是随着公司业务的增长，需要越来越多专项于某一职能的人员，比如需要招一批不需要会数据库只需要会java的人。这个时候，如果只招java工程师，客户端的需求就是java能力，接口还提供了数据库能力的要求，这是违背接口隔离原则的。依据接口隔离原则，这样的设计应该要进行拆分，我们对上面的方法进行重构，类图如下：</p>
<p><img src="http://zhaozg.vip/Java/DesignPattern/Images/isp/1547396449851.png" alt="1547396449851"></p>
<p>代码实现如下：</p>
<p>ICandidateForJava:</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">ICandidateForJava</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">	<span class="comment">//具备java能力</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">javaAbility</span><span class="params">()</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>ICandidateForDB：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">ICandidateForDB</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">	<span class="comment">//具备数据库能力</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">databaseAbility</span><span class="params">()</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>当招java工程师时：</p>
<p>Candidate实现ICandidateForJava接口即可</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Candidate</span> <span class="keyword">implements</span> <span class="title">ICandidateForJava</span></span>&#123;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">private</span> String candidateName;</span><br><span class="line">	</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="title">Candidate</span><span class="params">(String _candidateName)</span></span></span><br><span class="line"><span class="function">	</span>&#123;</span><br><span class="line">		<span class="keyword">this</span>.candidateName=_candidateName;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="meta">@Override</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">javaAbility</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="comment">// TODO Auto-generated method stub</span></span><br><span class="line">		System.out.println(<span class="string">"我是"</span>+candidateName+<span class="string">"我是高手，我会java"</span>);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>当招数据库工程师时：</p>
<p>Candidate实现ICandidateForDB接口即可</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Candidate</span> <span class="keyword">implements</span> <span class="title">ICandidateForDB</span></span>&#123;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">private</span> String candidateName;</span><br><span class="line">	</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="title">Candidate</span><span class="params">(String _candidateName)</span></span></span><br><span class="line"><span class="function">	</span>&#123;</span><br><span class="line">		<span class="keyword">this</span>.candidateName=_candidateName;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="meta">@Override</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">databaseAbility</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="comment">// TODO Auto-generated method stub</span></span><br><span class="line">		System.out.println(<span class="string">"我是"</span>+candidateName+<span class="string">"我是高手，我会数据库"</span>);</span><br><span class="line">	&#125;</span><br><span class="line">s</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>如果又需要一个既会java又会数据的，Candidate同时实现ICandidateForJava和CandidateForDB接口</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Candidate</span> <span class="keyword">implements</span> <span class="title">ICandidateForJava</span>,<span class="title">ICandidateForDB</span></span>&#123;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">private</span> String candidateName;</span><br><span class="line">	</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="title">Candidate</span><span class="params">(String _candidateName)</span></span></span><br><span class="line"><span class="function">	</span>&#123;</span><br><span class="line">		<span class="keyword">this</span>.candidateName=_candidateName;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="meta">@Override</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">databaseAbility</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="comment">// TODO Auto-generated method stub</span></span><br><span class="line">		System.out.println(<span class="string">"我是"</span>+candidateName+<span class="string">"我是高手，我会数据库"</span>);</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="meta">@Override</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">javaAbility</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="comment">// TODO Auto-generated method stub</span></span><br><span class="line">		System.out.println(<span class="string">"我是"</span>+candidateName+<span class="string">"我是高手，我会java"</span>);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h2><p>&emsp;&emsp;接口隔离原则是对接口和类的定义，接口和类尽量使用原子接口或原子类来组装，如何来设计需要结合实际情况。</p>
<p>&emsp;&emsp;关于定制服务：在项目实施过程中，有时候为了缩减工期，减少开发成本，就会出现违背接口隔离原则的情况。比如在项目中出现了查看数据的需求，开发设计时很有可能会设计一个大的接口，将需要查看的数据都从同一接口调用，谁需要看什么数据自己拿。系统刚运行时，可能问题不明显，但是在后续运行过程中，极有可能会出现性能问题。</p>
<p>&emsp;&emsp;另，接口隔离与单一职责的区别：在单一职责中，一个接口可以有多个方法，只要他们是完成同一职责即可。但是接口隔离原则希望每个接口尽可能拆分方法。</p>

          
        
      
    </div>
    
    
    
    
    <div>
		  
		</div>
		
		<div>
      
		</div>

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope="" itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://blog.zhaozg.top/2018/12/16/2/">

    <span hidden itemprop="author" itemscope="" itemtype="http://schema.org/Person">
      <meta itemprop="name" content="逃梦">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="逃梦红尘">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/12/16/2/" itemprop="url">设计原则之依赖倒置</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-12-16T00:21:12+08:00">
                2018-12-16
              </time>
            

            

            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope="" itemtype="http://schema.org/Thing">
                  <a href="/categories/设计原则/" itemprop="url" rel="index">
                    <span itemprop="name">设计原则</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <span class="post-meta-item-icon">
                  <i class="fa fa-comment-o"></i>
                </span>
                <a href="/2018/12/16/2/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count valine-comment-count" data-xid="/2018/12/16/2/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          
          

          

          
            <div class="post-wordcount">
              
                
                <span class="post-meta-item-icon">
                  <i class="fa fa-file-word-o"></i>
                </span>
                
                  <span class="post-meta-item-text">字数统计&#58;</span>
                
                <span title="字数统计">
                  1.7k
                </span>
              

              
                <span class="post-meta-divider">|</span>
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-clock-o"></i>
                </span>
                
                  <span class="post-meta-item-text">阅读时长 &asymp;</span>
                
                <span title="阅读时长">
                  7
                </span>
              
            </div>
          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h3 id="设计原则之依赖倒置"><a href="#设计原则之依赖倒置" class="headerlink" title="设计原则之依赖倒置"></a>设计原则之依赖倒置</h3><p>—-逃梦</p>
<h2 id="定义"><a href="#定义" class="headerlink" title="定义"></a>定义</h2><p>&emsp;&emsp;依赖倒置原则。</p>
<p>&emsp;&emsp;英文全称：Dependence Inversion Principle。</p>
<p>&emsp;&emsp;简称：DIP</p>
<p>&emsp;&emsp;英文定义：High level modules should not depend upon low level modules. Both should depend upon abstractions, Abstractions should not depend upon details. Details should depend upon abstractions.</p>
<p>&emsp;&emsp;中文解释：</p>
<ul>
<li>高层模块不应该依赖低层模块，他们都应该依赖其抽象。</li>
<li>抽象不应该依赖细节。</li>
<li>细节应该依赖抽象。</li>
</ul>
<h2 id="核心思想"><a href="#核心思想" class="headerlink" title="核心思想"></a>核心思想</h2><p>&emsp;&emsp;不可分割的原子逻辑即为低层模块，由原子逻辑组装而成的为高层模块。抽象是指接口或者抽象类。细节是指具体的实现类。依赖倒置原则可以通俗理解为模块之间不直接发生依赖关系，而是通过接口或者抽象类发生依赖关系。在接口和抽象类中不依赖具体的实现类，而实现类依赖的是接口或抽象类。</p>
<p>&emsp;&emsp;依赖倒置 —-&gt; 面向接口编程(OOD : Object-Oriented Design)</p>
<h2 id="好处"><a href="#好处" class="headerlink" title="好处"></a>好处</h2><ul>
<li>降低类之间的耦合度</li>
<li>提高系统稳定性</li>
<li>降低并行开发风险</li>
<li>提高代码可读性和可维护性</li>
</ul>
<h2 id="难点"><a href="#难点" class="headerlink" title="难点"></a>难点</h2><ul>
<li>项目中可能存在一些情况必须依赖细节；</li>
<li>在实际项目中，依据项目大小，工期等原因，需要综合考虑是否需要严格执行原则。</li>
</ul>
<h2 id="建议"><a href="#建议" class="headerlink" title="建议"></a>建议</h2><ul>
<li>每个类尽量都有接口或抽象类，或者抽象类和接口两者都具备</li>
<li>变量的表面类型尽量是接口或者抽象类</li>
<li>任何类都尽可能不从具体类派生</li>
<li>尽可能不覆写基类中已经实现的方法</li>
<li>结合里氏替换原则：接口负责定义Public属性和方法，并声明与其他对象的依赖关系。抽嫌类负责公共构造部分的实现。实现类负责准确的实现业务逻辑，同时在适当情况下对父类进行细化。</li>
</ul>
<h2 id="实践"><a href="#实践" class="headerlink" title="实践"></a>实践</h2><p>&emsp;&emsp;最近在学古筝，就以乐器为例。比如一个人会弹古筝，定义为两个类：Person和 GuZheng，分别存储Person的Play方法，和GuZheng的Perform方法，然后通过一个Client类来组合Person类和GuZheng类。</p>
<p>&emsp;&emsp;类图如下：</p>
<p><img src="http://zhaozg.vip/Java/DesignPattern/Images/dip/1547368307889.png" alt="1547368307889"></p>
<p>&emsp;&emsp;代码如下：</p>
<p>&emsp;&emsp;Person类：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Person</span> </span>&#123;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">play</span><span class="params">(GuZheng guzheng)</span> </span>&#123;</span><br><span class="line">		guzheng.perform();</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>&emsp;&emsp;GuZheng类：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">GuZheng</span> </span>&#123;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">perform</span><span class="params">()</span></span></span><br><span class="line"><span class="function">	</span>&#123;</span><br><span class="line">		System.out.println(<span class="string">"古筝演奏"</span>);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>&emsp;&emsp;Client类：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Client</span> </span>&#123;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">		<span class="comment">// TODO Auto-generated method stub</span></span><br><span class="line">		Person person=<span class="keyword">new</span> Person();</span><br><span class="line">		GuZheng guZheng=<span class="keyword">new</span> GuZheng();</span><br><span class="line">		person.play(guZheng);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>这样就描述清楚了一个人演奏古筝的过程。接下来，这个人又学习了钢琴，那么，这个时候，我们先定义一个钢琴的类出来：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Piano</span> </span>&#123;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">perform</span><span class="params">()</span></span></span><br><span class="line"><span class="function">	</span>&#123;</span><br><span class="line">		System.out.println(<span class="string">"钢琴演奏"</span>);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>类定义出来了，那么如何让这个人去演奏这个钢琴呢，需要重新去修改Person类和Client类，比如需要在Person类中增加对于Piano的方法，然后在Client中重新调用。或者在Person类中通过instanceOf的方式来进行判断，增加分别处理的逻辑。在当前实现方式的情况下，无论哪种方法，每增加一个乐器类型，就需要修改Person，这说明这种设置导致类之间的耦合度过高，那么通过什么样的方式来降低耦合度呢？依据依赖倒置原则进行重构。</p>
<p>类图：</p>
<p><img src="http://zhaozg.vip/Java/DesignPattern/Images/dip/1547370171026.png" alt="1547370171026"></p>
<p>代码：</p>
<p>IInstrument类：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">IInstrument</span> </span>&#123;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">perform</span><span class="params">()</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>IPerson类：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">IPerson</span> </span>&#123;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">play</span><span class="params">(IInstrument iInstrument)</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>Person类：传入IInstrument接口实现抽象之间的依赖。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Person</span> <span class="keyword">implements</span> <span class="title">IPerson</span> </span>&#123;</span><br><span class="line">	<span class="meta">@Override</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">play</span><span class="params">(IInstrument iInstrument)</span> </span>&#123;</span><br><span class="line">		<span class="comment">// TODO Auto-generated method stub</span></span><br><span class="line">		iInstrument.perform();</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>GuZheng类：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">GuZheng</span> <span class="keyword">implements</span> <span class="title">IInstrument</span> </span>&#123;</span><br><span class="line">	<span class="meta">@Override</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">perform</span><span class="params">()</span></span></span><br><span class="line"><span class="function">	</span>&#123;</span><br><span class="line">		System.out.println(<span class="string">"古筝演奏"</span>);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>Piano类：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Piano</span> <span class="keyword">implements</span> <span class="title">IInstrument</span> </span>&#123;</span><br><span class="line">	<span class="meta">@Override</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">perform</span><span class="params">()</span></span></span><br><span class="line"><span class="function">	</span>&#123;</span><br><span class="line">		System.out.println(<span class="string">"钢琴演奏"</span>);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>Client类：高层模块中变量的表面类型使用接口</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Client</span> </span>&#123;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">		<span class="comment">// TODO Auto-generated method stub</span></span><br><span class="line">		IPerson person=<span class="keyword">new</span> Person();</span><br><span class="line">		IInstrument iInstrument=<span class="keyword">new</span> GuZheng();<span class="comment">//演奏古筝</span></span><br><span class="line">        IInstrument iInstrument=<span class="keyword">new</span> Piano();<span class="comment">//演奏钢琴</span></span><br><span class="line">		person.play(iInstrument);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>按照这样的设计方式，如果有一天增加了口琴，那么只需要让口琴实现类实现IInstrument接口，然后在Client中直接指定具体实现类即可。</p>
<p>代码：</p>
<p>Harmonic类</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Harmonic</span> <span class="keyword">implements</span> <span class="title">IInstrument</span> </span>&#123;</span><br><span class="line">	<span class="meta">@Override</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">perform</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="comment">// TODO Auto-generated method stub</span></span><br><span class="line">		System.out.println(<span class="string">"口琴演奏"</span>);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>Client类：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Client</span> </span>&#123;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">		<span class="comment">// TODO Auto-generated method stub</span></span><br><span class="line">		IPerson person=<span class="keyword">new</span> Person();</span><br><span class="line">		IInstrument iInstrument=<span class="keyword">new</span> GuZheng();<span class="comment">//演奏古筝</span></span><br><span class="line">        IInstrument iInstrument=<span class="keyword">new</span> Piano();<span class="comment">//演奏钢琴</span></span><br><span class="line">        IInstrument iInstrument=<span class="keyword">new</span> Harmonic();<span class="comment">//演奏口琴</span></span><br><span class="line">		person.play(iInstrument);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>通过这样的设计，降低了类之间的耦合度，提升了扩展性、灵活性、系统的健壮性，维护性。</p>
<p>同时，从并行开发的角度来说，假设Person类的实现和Insrument类的实现由不同人员并行开发，Person类已经完成，Instrument类尚未实现，可以通过JMoke这样的工具虚拟一个对象来进行测试，不必等待Instrument开发完成后才能测试，提供了并行度。</p>
<p>测试代码：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> org.jmock.Expectations;</span><br><span class="line"><span class="keyword">import</span> org.jmock.Mockery;</span><br><span class="line"><span class="keyword">import</span> org.jmock.integration.junit4.JUnit4Mockery;</span><br><span class="line"><span class="keyword">import</span> org.junit.Test;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> junit.framework.TestCase;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">PersonTest</span> <span class="keyword">extends</span> <span class="title">TestCase</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">	Mockery mockery = <span class="keyword">new</span> JUnit4Mockery();</span><br><span class="line">	<span class="meta">@Test</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testPerson</span><span class="params">()</span></span></span><br><span class="line"><span class="function">	</span>&#123;</span><br><span class="line">		<span class="comment">//根据IInstrument接口虚拟一个对象</span></span><br><span class="line">		<span class="keyword">final</span> IInstrument instrument = mockery.mock(IInstrument.class);</span><br><span class="line">		IPerson person = <span class="keyword">new</span> Person();</span><br><span class="line">		<span class="comment">//使用内部类</span></span><br><span class="line">		mockery.checking(<span class="keyword">new</span> Expectations()&#123;&#123;oneOf(instrument).perform();&#125;&#125;);</span><br><span class="line">		</span><br><span class="line">		person.play(instrument);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>依赖的三种写法：</p>
<ul>
<li><p>构造函数传递依赖对象(构造函数注入)：</p>
<p>在类中通过构造函数声明依赖对象。</p>
<p>实践代码:</p>
<p>IPerson类：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">IPerson</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">play</span><span class="params">()</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>Person类：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//构造函数注入</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Person</span> <span class="keyword">implements</span> <span class="title">IPerson</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">	<span class="keyword">private</span> IInstrument instrument;</span><br><span class="line">	</span><br><span class="line">	<span class="comment">//在构造函数中引入依赖</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="title">Person</span><span class="params">(IInstrument _iInstrument)</span></span></span><br><span class="line"><span class="function">	</span>&#123;</span><br><span class="line">		<span class="keyword">this</span>.instrument=_iInstrument;</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="meta">@Override</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">play</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="comment">// TODO Auto-generated method stub</span></span><br><span class="line">		<span class="keyword">this</span>.instrument.perform();</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>Setter方法传递依赖对象(Setter依赖注入)</p>
<p>在抽象中使用Setter方法声明依赖。</p>
<p>实践代码：</p>
<p>IPerson类：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">IPerson</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setInstrument</span><span class="params">(IInstrument iInstrument)</span></span>;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">play</span><span class="params">()</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>Person类：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//setter依赖注入</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Person</span> <span class="keyword">implements</span> <span class="title">IPerson</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">	<span class="keyword">private</span> IInstrument instrument;</span><br><span class="line"></span><br><span class="line">	<span class="meta">@Override</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setInstrument</span><span class="params">(IInstrument iInstrument)</span> </span>&#123;</span><br><span class="line">		<span class="comment">// TODO Auto-generated method stub</span></span><br><span class="line">		<span class="keyword">this</span>.instrument=iInstrument;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="meta">@Override</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">play</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="comment">// TODO Auto-generated method stub</span></span><br><span class="line">		<span class="keyword">this</span>.instrument.perform();</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>接口声明依赖对象(接口注入)</p>
<p>在接口方法中引入依赖：</p>
<p>实践代码：</p>
<p>IPerson类：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">IPerson</span> </span>&#123;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">play</span><span class="params">(IInstrument iInstrument)</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>Person类：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Person</span> <span class="keyword">implements</span> <span class="title">IPerson</span> </span>&#123;</span><br><span class="line">	<span class="meta">@Override</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">play</span><span class="params">(IInstrument iInstrument)</span> </span>&#123;</span><br><span class="line">		<span class="comment">// TODO Auto-generated method stub</span></span><br><span class="line">		iInstrument.perform();</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
</ul>
<h2 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h2><p>&emsp;&emsp;依赖倒置原则的本质就是通过抽象(接口或抽象类)使各个类或模块的实现彼此独立，互不影响，降低类或模块间的耦合度。使用这一原则在项目中可以规避一些非技术因素引起的问题，比如需求变更，人员变动等。面向接口编程是依赖倒置原则的核心。</p>

          
        
      
    </div>
    
    
    
    
    <div>
		  
		</div>
		
		<div>
      
		</div>

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope="" itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://blog.zhaozg.top/2018/12/15/2/">

    <span hidden itemprop="author" itemscope="" itemtype="http://schema.org/Person">
      <meta itemprop="name" content="逃梦">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="逃梦红尘">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/12/15/2/" itemprop="url">设计原则之里氏替换</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-12-15T00:21:12+08:00">
                2018-12-15
              </time>
            

            

            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope="" itemtype="http://schema.org/Thing">
                  <a href="/categories/设计原则/" itemprop="url" rel="index">
                    <span itemprop="name">设计原则</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <span class="post-meta-item-icon">
                  <i class="fa fa-comment-o"></i>
                </span>
                <a href="/2018/12/15/2/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count valine-comment-count" data-xid="/2018/12/15/2/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          
          

          

          
            <div class="post-wordcount">
              
                
                <span class="post-meta-item-icon">
                  <i class="fa fa-file-word-o"></i>
                </span>
                
                  <span class="post-meta-item-text">字数统计&#58;</span>
                
                <span title="字数统计">
                  2.4k
                </span>
              

              
                <span class="post-meta-divider">|</span>
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-clock-o"></i>
                </span>
                
                  <span class="post-meta-item-text">阅读时长 &asymp;</span>
                
                <span title="阅读时长">
                  9
                </span>
              
            </div>
          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h3 id="设计原则之里氏替换"><a href="#设计原则之里氏替换" class="headerlink" title="设计原则之里氏替换"></a>设计原则之里氏替换</h3><p>—-逃梦</p>
<h2 id="定义"><a href="#定义" class="headerlink" title="定义"></a>定义</h2><p>&emsp;&emsp;里氏替换原则。</p>
<p>&emsp;&emsp;英文全称：Liskov Substitution Principle。</p>
<p>&emsp;&emsp;简称：LSP</p>
<p>&emsp;&emsp;英文定义1：If for earch object o1 of type S there is an object o2 of type T such that for all programs P defined in items of T, the behavior of P is unchanged when o1 is substituted for o2 then S is a subtype of T.</p>
<p>&emsp;&emsp;中文解释1：如果对每一个类型为S的对象o1，都有类型为T的对象o2，使得以T定义的所有程序P在所有的对象o1被替换成o2时，程序P的行为没有发生变化，那么类型S是类型T的子类型。</p>
<p>&emsp;&emsp;英文定义2：Functions that use pointers or references to base classes must be able to use objects of derived classes without knowing it.</p>
<p>&emsp;&emsp;中文解释2：所有引用基类的地方必须能透明的使用其子类的对象。通俗的讲，只要父类能出现的地方子类就可以出现，而且将父类替换为子类不会导致程序出现任何错误或者异常，但是，反过来不行，有子类出现的地方，替换为父类程序未必还能正常。</p>
<h2 id="核心思想"><a href="#核心思想" class="headerlink" title="核心思想"></a>核心思想</h2><p>&emsp;&emsp;使用基类的地方可以随意使用其子类。这一原则是对继承机制进行约束规范的体现，它保证了基类能真正的被复用，衍生类在基类基础上增加新的行为。</p>
<h2 id="好处"><a href="#好处" class="headerlink" title="好处"></a>好处</h2><p>&emsp;&emsp;增强程序的健壮性，可扩展性。</p>
<h2 id="难点"><a href="#难点" class="headerlink" title="难点"></a>难点</h2><p>&emsp;&emsp;在使用里氏替换原则，要求尽量避免子类的“个性”，因为子类一旦有“个性”，则子类和父类的关系难以调和，把子类作为父类使用，子类的“个性”会被抹杀。使用子类作为单独的一个业务来使用，则会让代码的耦合关系变得扑朔迷离，缺乏类替换的标准。</p>
<h2 id="建议"><a href="#建议" class="headerlink" title="建议"></a>建议</h2><ul>
<li>子类可以实现父类的抽象方法，但是不能覆盖父类的非抽象方法</li>
<li>子类可以增加自己的特有属性或行为</li>
<li>当子类覆写或实现父类的方法时，方法的前置条件(即方法的形参) &gt;= 父类方法的输入参数范围</li>
<li>当子类覆写或实现父类的方法时，方法的后置条件(即方法的输出结果) &lt;= 父类方法的输出结果范围</li>
</ul>
<h2 id="实践"><a href="#实践" class="headerlink" title="实践"></a>实践</h2><ul>
<li><p>符合里氏替换原则</p>
<p>比如我们的系统中会有用户管理，那么对于所有的用户我们定义一个类为User，我们还会有一些会员用户，我们为会员用户定义一个类为VIPUser，并且该类继承自User类。</p>
<p>其类图如下：</p>
<p><img src="http://zhaozg.vip/Java/DesignPattern/Images/lsp/1547290499422.png" alt="1547290499422"></p>
<p>&emsp;&emsp;在这个类图中，User类包含一个userDescription的方法，VIPUser类继承自User类，所以也会继承userDescription方法，并且VIPUser类拥有获得折扣的特权。通过以下代码实现这个类图，并在Client类中通过main方法体现父类可以被子类替换的情况。</p>
<p>&emsp;&emsp;User类：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">User</span> </span>&#123;</span><br><span class="line">	</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">userDescription</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="comment">// TODO Auto-generated method stub</span></span><br><span class="line">		System.out.println(<span class="string">"我是一个普通用户"</span>);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>&emsp;&emsp;VIPUser类：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">VIPUser</span> <span class="keyword">extends</span> <span class="title">User</span> </span>&#123;</span><br><span class="line">	</span><br><span class="line">	<span class="meta">@Override</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">userDescription</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="comment">// TODO Auto-generated method stub</span></span><br><span class="line">		System.out.println(<span class="string">"我是一个VIP用户"</span>);</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">getDistount</span><span class="params">()</span></span></span><br><span class="line"><span class="function">	</span>&#123;</span><br><span class="line">		System.out.println(<span class="string">"我获得了9折优惠"</span>);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>&emsp;&emsp;在Client类中直接调用父类，及使用子类替换父类：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span></span></span><br><span class="line"><span class="function">	</span></span><br><span class="line"><span class="function">	</span>&#123;</span><br><span class="line">		User user;</span><br><span class="line">		<span class="comment">//调用父类</span></span><br><span class="line">		user=<span class="keyword">new</span> User();		</span><br><span class="line">		user.userDescription();</span><br><span class="line">		<span class="comment">//用子类替换父类</span></span><br><span class="line">		user=<span class="keyword">new</span> VIPUser();		</span><br><span class="line">		user.userDescription();</span><br><span class="line">	&#125;</span><br></pre></td></tr></table></figure>
<p>&emsp;&emsp;输出结果：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">--&gt;我是一个普通用户</span><br><span class="line">--&gt;我是一个VIP用户</span><br></pre></td></tr></table></figure>
<p>&emsp;&emsp;通过这个代码，可以看出，在使用父类User的位置，直接替换成子类VIPUser，程序仍然可以正常执行，这就符合里氏替换原则。</p>
</li>
<li><p>子类无法满足父类业务功能</p>
<p>&emsp;&emsp;我们在父类中定义了必须实现的抽象业务功能，要求子类在继承父类时实现这些业务功能以满足业务逻辑，但是当某一子类在继承父类后发现该子类无法完全实现父类的方法，或者重写父类方法后已经发生畸变，导致业务逻辑无法运行，这种情况下，建议断开父子继承关系，采用依赖、聚合、组合的方式代替继承。</p>
<p>&emsp;&emsp;比如一台电脑，包含了屏幕、主机、键盘、鼠标等硬件，我们定义一个抽象类作为父类，来显示各个部件的功能。后续的电脑作为子类来继承这个抽象类。</p>
<p>&emsp;&emsp;其类图如下：</p>
<p><img src="http://zhaozg.vip/Java/DesignPattern/Images/lsp/1547316870168.png" alt="1547316870168"></p>
<p>&emsp;&emsp;其代码如下：</p>
<p>&emsp;&emsp;AbstractComputer:</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="class"><span class="keyword">class</span> <span class="title">AbstractComputer</span> </span>&#123;</span><br><span class="line">	<span class="comment">//屏幕的功能</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="keyword">void</span> <span class="title">screenFunction</span><span class="params">()</span></span>;</span><br><span class="line">	<span class="comment">//主机的功能</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="keyword">void</span> <span class="title">HostFunction</span><span class="params">()</span></span>;</span><br><span class="line">	<span class="comment">//键盘的功能</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="keyword">void</span> <span class="title">keyboardFunction</span><span class="params">()</span></span>;</span><br><span class="line">	<span class="comment">//鼠标的功能</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="keyword">void</span> <span class="title">mouseFunction</span><span class="params">()</span></span>;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>&emsp;&emsp;Computer:</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Computer</span> <span class="keyword">extends</span> <span class="title">AbstractComputer</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">	<span class="meta">@Override</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">screenFunction</span><span class="params">()</span></span></span><br><span class="line"><span class="function">	</span>&#123;</span><br><span class="line">		System.out.println(<span class="string">"这里是电脑屏幕的功能"</span>);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="meta">@Override</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">hostFunction</span><span class="params">()</span></span></span><br><span class="line"><span class="function">	</span>&#123;</span><br><span class="line">		System.out.println(<span class="string">"这里是电脑主机的功能"</span>);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="meta">@Override</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">keyboardFunction</span><span class="params">()</span></span></span><br><span class="line"><span class="function">	</span>&#123;</span><br><span class="line">		System.out.println(<span class="string">"这里是电脑键盘的功能"</span>);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="meta">@Override</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">mouseFunction</span><span class="params">()</span></span></span><br><span class="line"><span class="function">	</span>&#123;</span><br><span class="line">		System.out.println(<span class="string">"这里是电脑鼠标的功能"</span>);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>&emsp;&emsp;在Computer子类中完全实现了AbstractComputer中的方法，且他们之间是符合里氏替换原则的。但是，有一天，出现了平板电脑Tablet，平板电脑也是电脑呀，于是，我们一开始考虑让Tablet作为AbstractComputer的子类，其类图如下：</p>
<p><img src="http://zhaozg.vip/Java/DesignPattern/Images/lsp/1547316902078.png" alt="1547316902078"></p>
<p>&emsp;&emsp;可是，平板电脑没有鼠标和键盘的硬件概念，而是增加了一个屏幕触摸功能。那么当Table类实现父类方法的时候代码如下：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Tablet</span> <span class="keyword">extends</span> <span class="title">AbstractComputer</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">	<span class="meta">@Override</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">screenFunction</span><span class="params">()</span></span></span><br><span class="line"><span class="function">	</span>&#123;</span><br><span class="line">		System.out.println(<span class="string">"这里是电脑屏幕的功能"</span>);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="meta">@Override</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">hostFunction</span><span class="params">()</span></span></span><br><span class="line"><span class="function">	</span>&#123;</span><br><span class="line">		System.out.println(<span class="string">"这里是电脑主机的功能"</span>);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="meta">@Override</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">keyboardFunction</span><span class="params">()</span></span></span><br><span class="line"><span class="function">	</span>&#123;</span><br><span class="line">		<span class="comment">//由于平板电脑没有硬件键盘，该方法不实现;</span></span><br><span class="line">	&#125;</span><br><span class="line">	<span class="meta">@Override</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">mouseFunction</span><span class="params">()</span></span></span><br><span class="line"><span class="function">	</span>&#123;</span><br><span class="line">		<span class="comment">//由于平板电脑没有硬件鼠标，该方法不实现;</span></span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">touchFunction</span><span class="params">()</span></span></span><br><span class="line"><span class="function">	</span>&#123;</span><br><span class="line">		System.out.println(<span class="string">"平板电脑具有触摸功能"</span>);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>&emsp;&emsp;此时，在调用父类AbstractComputer的地方，如果使用Tablet子类来替换的话，就会导致某些业务功能无法进行，这就违背了里氏替换原则。</p>
<p>&emsp;&emsp;这种情况下，建议单独定义一个AbstractTablet父类，并且将屏幕与主机的属性、方法委托给AbstractComputer来处理。其类图如下：</p>
<p><img src="http://zhaozg.vip/Java/DesignPattern/Images/lsp/1547325092171.png" alt="1547317515778"></p>
<p>&emsp;&emsp;</p>
<p>&emsp;&emsp;代码如下：</p>
<p>&emsp;&emsp;AbstractTablet:</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="class"><span class="keyword">class</span> <span class="title">AbstractTablet</span> </span>&#123;</span><br><span class="line">	<span class="keyword">protected</span> AbstractComputer abstractComputer;</span><br><span class="line">	</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="title">AbstractTablet</span><span class="params">(AbstractComputer _abstractComput)</span></span></span><br><span class="line"><span class="function">	</span>&#123;</span><br><span class="line">		<span class="keyword">this</span>.abstractComputer=_abstractComput;</span><br><span class="line">	&#125;</span><br><span class="line">		</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="keyword">void</span> <span class="title">touchFunction</span><span class="params">()</span></span>;</span><br><span class="line"></span><br><span class="line">	<span class="comment">//将显示屏幕和主机的功能委托给AbstractComputer类来处理</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">screenFunction</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="comment">// TODO Auto-generated method stub</span></span><br><span class="line">		abstractComputer.screenFunction();</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">hostFunction</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="comment">// TODO Auto-generated method stub</span></span><br><span class="line">		abstractComputer.hostFunction();</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>&emsp;&emsp;Tablet:</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Tablet</span> <span class="keyword">extends</span> <span class="title">AbstractTablet</span></span>&#123;</span><br><span class="line"></span><br><span class="line">	</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="title">Tablet</span><span class="params">(AbstractComputer _abstractComputer)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">super</span>(_abstractComputer);</span><br><span class="line">		<span class="comment">// TODO Auto-generated constructor stub</span></span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="meta">@Override</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">touchFunction</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="comment">// TODO Auto-generated method stub</span></span><br><span class="line">		System.out.println(<span class="string">"平板电脑具有触摸功能"</span>);</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span></span></span><br><span class="line"><span class="function">	</span>&#123;</span><br><span class="line">		AbstractTablet tablet=<span class="keyword">new</span> Tablet(<span class="keyword">new</span> Computer());</span><br><span class="line">		tablet.screenFunction();</span><br><span class="line">		tablet.hostFunction();</span><br><span class="line">		tablet.touchFunction();</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>子类可以增加自己的特有属性或行为</p>
<p>&emsp;&emsp;比如给Computer增加了一个摄像头功能。那么此时在使用父类的位置替换为子类，是可行的，但是在使用子类的的位置替换为父类不可行的，会报java.lang.ClassCastException异常，即向下转型不成功。也就是里氏替换原则中的有子类出现的地方父类未必可以出现。</p>
</li>
<li><p>当子类覆写或实现父类的方法时，方法的前置条件(即方法的形参) &gt;= 父类方法的输入参数范围</p>
<p>&emsp;&emsp;我们定义的AbstractComputer是Computer的父类，通过定义一个Father类和一个Son类，并分别修改其中getComputer中的参数来验证该说法。</p>
<p>&emsp;&emsp;代码如下：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Father</span> </span>&#123;</span><br><span class="line">	</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">getComputer</span><span class="params">(Computer computer)</span></span></span><br><span class="line"><span class="function">	</span>&#123;</span><br><span class="line">		System.out.println(<span class="string">"父类被调用"</span>);</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Son</span> <span class="keyword">extends</span> <span class="title">Father</span></span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//重写getComputer方法</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">getComputer</span><span class="params">(AbstractComputer abstractComputer)</span> </span>&#123;</span><br><span class="line">		<span class="comment">// TODO Auto-generated method stub</span></span><br><span class="line">		System.out.println(<span class="string">"子类被调用"</span>);</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span></span></span><br><span class="line"><span class="function">	</span>&#123;</span><br><span class="line">		<span class="comment">//Father father=new Father();</span></span><br><span class="line">		<span class="comment">//father.getComputer(new Computer());</span></span><br><span class="line">		<span class="comment">//替换为子类</span></span><br><span class="line">		Son father=<span class="keyword">new</span> Son();</span><br><span class="line">		father.getComputer(<span class="keyword">new</span> Computer());</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
</ul>
<p>&emsp;&emsp;此时子类的参数AbstractComputer比父类的参数Computer范围大，将父类替换为子类后，输出结果为：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">--&gt;父类被调用</span><br></pre></td></tr></table></figure>
<p>&emsp;&emsp;遵循里氏替换原则。</p>
<p>&emsp;&emsp;交换一下参数，代码如下：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Father</span> </span>&#123;</span><br><span class="line">	</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">getComputer</span><span class="params">(AbstractComputer abstractComputer)</span></span></span><br><span class="line"><span class="function">	</span>&#123;</span><br><span class="line">		System.out.println(<span class="string">"父类被调用"</span>);</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Son</span> <span class="keyword">extends</span> <span class="title">Father</span></span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//重写getComputer方法</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">getComputer</span><span class="params">(Computer computer)</span> </span>&#123;</span><br><span class="line">		<span class="comment">// TODO Auto-generated method stub</span></span><br><span class="line">		System.out.println(<span class="string">"子类被调用"</span>);</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span></span></span><br><span class="line"><span class="function">	</span>&#123;</span><br><span class="line">		<span class="comment">//Father father=new Father();</span></span><br><span class="line">		<span class="comment">//father.getComputer(new Computer());</span></span><br><span class="line">		<span class="comment">//替换为子类</span></span><br><span class="line">		Son father=<span class="keyword">new</span> Son();</span><br><span class="line">		father.getComputer(<span class="keyword">new</span> Computer());</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>&emsp;&emsp;此时子类的参数Computer比父类的参数AbstractComputer范围小，将父类替换为子类后，输出结果为：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">--&gt;子类被调用</span><br></pre></td></tr></table></figure>
<p>&emsp;&emsp;用子类替换父类后，执行结果发生变化，违背了里氏替换原则。</p>
<ul>
<li><p>当子类覆写或实现父类的方法时，方法的后置条件(即方法的输出结果) &lt;= 父类方法的输出结果范围</p>
<p>分两种情况：</p>
<ul>
<li><p>覆写@Override，要求子类返回值的范围必须小于等于父类返回值的范围。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">abstract</span> <span class="class"><span class="keyword">class</span> <span class="title">Father</span> </span>&#123;</span><br><span class="line">	</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">abstract</span> AbstractComputer <span class="title">getComputer</span><span class="params">()</span></span>;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Son</span> <span class="keyword">extends</span> <span class="title">Father</span></span>&#123;</span><br><span class="line"></span><br><span class="line">	<span class="meta">@Override</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> Computer <span class="title">getComputer</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="comment">// TODO Auto-generated method stub</span></span><br><span class="line">		<span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>重写@Overload，因为输入的参数类型和数量不一致，此时参考前置条件。</p>
</li>
</ul>
</li>
</ul>
<h2 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h2><p>&emsp;&emsp;里氏替换原则为良好的继承定义了一个规范。</p>

          
        
      
    </div>
    
    
    
    
    <div>
		  
		</div>
		
		<div>
      
		</div>

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope="" itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://blog.zhaozg.top/2018/12/14/1/">

    <span hidden itemprop="author" itemscope="" itemtype="http://schema.org/Person">
      <meta itemprop="name" content="逃梦">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="逃梦红尘">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/12/14/1/" itemprop="url">从零开始做游戏(一)：环境搭建</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-12-14T00:21:15+08:00">
                2018-12-14
              </time>
            

            

            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope="" itemtype="http://schema.org/Thing">
                  <a href="/categories/游戏开发/" itemprop="url" rel="index">
                    <span itemprop="name">游戏开发</span>
                  </a>
                </span>

                
                
                  ， 
                
              
                <span itemprop="about" itemscope="" itemtype="http://schema.org/Thing">
                  <a href="/categories/游戏开发/Construct-2/" itemprop="url" rel="index">
                    <span itemprop="name">Construct 2</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <span class="post-meta-item-icon">
                  <i class="fa fa-comment-o"></i>
                </span>
                <a href="/2018/12/14/1/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count valine-comment-count" data-xid="/2018/12/14/1/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          
          

          

          
            <div class="post-wordcount">
              
                
                <span class="post-meta-item-icon">
                  <i class="fa fa-file-word-o"></i>
                </span>
                
                  <span class="post-meta-item-text">字数统计&#58;</span>
                
                <span title="字数统计">
                  1.5k
                </span>
              

              
                <span class="post-meta-divider">|</span>
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-clock-o"></i>
                </span>
                
                  <span class="post-meta-item-text">阅读时长 &asymp;</span>
                
                <span title="阅读时长">
                  5
                </span>
              
            </div>
          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h3 id="从零开始做游戏-一-：环境搭建"><a href="#从零开始做游戏-一-：环境搭建" class="headerlink" title="从零开始做游戏(一)：环境搭建"></a>从零开始做游戏(一)：环境搭建</h3><p>—-逃梦</p>
<h2 id="序"><a href="#序" class="headerlink" title="序"></a>序</h2><p>&emsp;&emsp;自2016年以来，为了通过游戏化的方式来提高少儿课程的趣味性，增加孩子的学习兴趣，开始接触游戏编程，并使用Construct 2游戏引擎完成了大量游戏、动画。</p>
<p>&emsp;&emsp;Construct 2是由Scirra公司开发的一款Html5戏开发引擎。其特点在于入门简单、可快速上手，即使是对编程一无所知的人也可以用它完成游戏作品。利用Construct 2，我们可以开发出各类游戏和动画。</p>
<p>&emsp;&emsp;虽然Construct 2使用起来比较简单，但其仍然不失为一款很好的编程入门工具，可以很好的锻炼编程思维。在国外的很多大学，Construct 2被选择作为编程入门工具。</p>
<p>&emsp;&emsp;在此，我将把Construct 2开发相关的内容整理成一个系列，希望为那些有兴趣学习编程，或者有兴趣进行游戏开发的朋友提供一点帮助。</p>
<p>&emsp;&emsp;该系列适合的读者：</p>
<ul>
<li><p>想要了解、学习编程的人</p>
<p>&emsp;&emsp;无论您之前是否具备编程基础，只要您渴望了解编程的世界，那么您可以从本系列内容中获得您想要的。</p>
</li>
<li><p>具备编程经验的人</p>
<p>&emsp;&emsp;作为一个已经具备了编程能力的人，阅读本系列内容您将会获得一项新的技能，同时，在学习Construct 2的过程中，有可能会对您之前的知识带来其它方面的和巩固和领悟。 </p>
</li>
<li><p>家长</p>
<p>&emsp;&emsp;就目前的形势来看，编程的学习应该从小开始，这里我们不建议强制给孩子添加太多的负担，那么我建议您尝试和孩子一同去体验一下编程的乐趣，本系列的大部分内容我都会以如何编写一款独立小游戏的方式来讲解，它真的是一个有趣的过程。与其给孩子一部手机去玩游戏，不如带着他一起做一款属于你们的游戏，在学习的同时体验一下亲子的乐趣，岂不快哉！也许它还能为您打开孩子的心扉，让您了解他们的想法，听到他们的心声，进入他们的世界，成为你们沟通的一座桥梁。 </p>
</li>
<li><p>孩子</p>
<p>&emsp;&emsp;也许你已经在学习编程的路上，也许你还只是有一个想法不知如何开始，也许你还没有听说过编程，无论如何，在未来的世界里，英语和编程都应该成为你必备的技能。你们应该会有很多新奇的、创新的想法，每一个想法的实现其实都是对一堆问题的解决，编程可以带领你们学会如何去发现问题，如何去拆分问题，如何去简化问题，如何去解决问题。可以的话，静下心来，跟着本系列中的内容，去把里面每个章节的小游戏实现出来，等你学会之后，把你的想法通过程序展示给大家，那将是一件多么炫酷的事情。 </p>
</li>
<li><p>其他人</p>
<p>&emsp;&emsp;如果您有一个想法，但不知道该如何用程序去实现，读完这个系列也许您就知道了。</p>
<p>&emsp;&emsp;如果您想出来一款不错的产品，您可以尝试用Construct 2做出一套很棒的原型，展示给大家，也许它会成为一款伟大的产品。</p>
<p>&emsp;&emsp;如果您想出来一款不错的游戏，您可以尝试用Construct 2去实现这个游戏，也许您会成为一名独立游戏开发者。</p>
<p>&emsp;&emsp;当然，如果您每天只是在无聊的打发时间，也可以学一学Construct 2，说不定能找到让您开始奋(赚)斗(钱)的方向呢。</p>
</li>
</ul>
<h2 id="Construct-2环境准备"><a href="#Construct-2环境准备" class="headerlink" title="Construct 2环境准备"></a>Construct 2环境准备</h2><p>&emsp;&emsp;Construct 2目前包含了免费版、个人版(199.99美元)和企业版(499.99美元)。免费版包含基本功能，可发布Html5游戏，个人版包含所有功能，只限个人使用，不得用于企业组织，用Construct 2开发的游戏收入超过5000美元后，必须购买企业版，企业版包含所有功能，无使用限制。</p>
<p>&emsp;&emsp;本书中所有案例将在免费版的基础上实现，如需使用个人版或者企业版，请到官<a href="https://www.scirra.com/" target="_blank" rel="noopener">https://www.scirra.com/</a> 进行购买。</p>
<p>&emsp;&emsp;同时，该工具目前也已经出了Construct 3，可以在网页浏览器直接使用的版本，感兴趣的朋友可以直接登录<a href="https://www.scirra.com/" target="_blank" rel="noopener">https://www.scirra.com/</a>试用。 </p>
<h3 id="安装条件"><a href="#安装条件" class="headerlink" title="安装条件"></a>安装条件</h3><p>&emsp;&emsp;一台使用Windows操作系统的电脑，一个支持Html5的浏览器，比如Windows系统自带的Internet Explorer11，这里建议使用[Google chrome (谷歌浏览器)][<a href="https://www.google.cn/chrome/]。" target="_blank" rel="noopener">https://www.google.cn/chrome/]。</a> </p>
<h3 id="Construct-2下载"><a href="#Construct-2下载" class="headerlink" title="Construct 2下载"></a>Construct 2下载</h3><p>&emsp;&emsp;官方下载地址：<a href="https://www.scirra.com/construct2/releases" target="_blank" rel="noopener">https://www.scirra.com/construct2/releases</a> </p>
<p>&emsp;&emsp;本系列内容使用Construct 2 r259，我已上传至网盘供大家下载。</p>
<p>&emsp;&emsp;下载地址：<a href="https://pan.baidu.com/s/1-kLOB6ZZeLCAnSlvS8Nwww" target="_blank" rel="noopener">https://pan.baidu.com/s/1-kLOB6ZZeLCAnSlvS8Nwww</a> </p>
<p>&emsp;&emsp;提取码：jfae</p>
<h3 id="Construct-2安装"><a href="#Construct-2安装" class="headerlink" title="Construct 2安装"></a>Construct 2安装</h3><p>&emsp;&emsp;下载完成后，在下载的位置找到construct2-r259-setup.exe，双击开始安装。(下面是软件安装步骤，知道如何安装的可以跳过。) </p>
<p><img src="http://zhaozg.vip/Construct2Sets/C1/1544719205432.png" alt="1544719205432"></p>
<p><img src="http://zhaozg.vip/Construct2Sets/C1/1544719230896.png" alt="1544719230896"></p>
<p><img src="http://zhaozg.vip/Construct2Sets/C1/1544719243382.png" alt="1544719243382"></p>
<p><img src="http://zhaozg.vip/Construct2Sets/C1/1544719254309.png" alt="1544719254309"></p>
<p><img src="http://zhaozg.vip/Construct2Sets/C1/1544719268515.png" alt="1544719268515"></p>
<p><img src="http://zhaozg.vip/Construct2Sets/C1/1544719278430.png" alt="1544719278430"></p>
<p><img src="http://zhaozg.vip/Construct2Sets/C1/1544719286406.png" alt="1544719286406"></p>
<p><img src="http://zhaozg.vip/Construct2Sets/C1/1544719293974.png" alt="1544719293974"></p>
<p><img src="http://zhaozg.vip/Construct2Sets/C1/1544719305771.png" alt="1544719305771"></p>
<p>&emsp;&emsp;如出现下面窗口，直接关闭即可。</p>
<p><img src="http://zhaozg.vip/Construct2Sets/C1/1544719330467.png" alt="1544719330467"></p>
<p><img src="http://zhaozg.vip/Construct2Sets/C1/1544719347848.png" alt="1544719347848"></p>
<p>&emsp;&emsp;也有可能打开Construct 2后的页面如下图，那是因为开始页被关闭了，也没有关系。 </p>
<p><img src="http://zhaozg.vip/Construct2Sets/C1/1544719386575.png" alt="1544719386575"></p>
<p>&emsp;&emsp;现在，我们的编程环境就准备好了。下一节，让我们来了解一下这个工具的各个组成部分，以便于后续我们知道在什么位置寻找什么控件，进行什么操作。并且我们将会编写我们的第一个简单的程序。 </p>
<p>​    </p>

          
        
      
    </div>
    
    
    
    
    <div>
		  
		</div>
		
		<div>
      
		</div>

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope="" itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://blog.zhaozg.top/2018/12/14/2/">

    <span hidden itemprop="author" itemscope="" itemtype="http://schema.org/Person">
      <meta itemprop="name" content="逃梦">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="逃梦红尘">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/12/14/2/" itemprop="url">设计原则之单一职责</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-12-14T00:21:12+08:00">
                2018-12-14
              </time>
            

            

            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope="" itemtype="http://schema.org/Thing">
                  <a href="/categories/设计原则/" itemprop="url" rel="index">
                    <span itemprop="name">设计原则</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <span class="post-meta-item-icon">
                  <i class="fa fa-comment-o"></i>
                </span>
                <a href="/2018/12/14/2/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count valine-comment-count" data-xid="/2018/12/14/2/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          
          

          

          
            <div class="post-wordcount">
              
                
                <span class="post-meta-item-icon">
                  <i class="fa fa-file-word-o"></i>
                </span>
                
                  <span class="post-meta-item-text">字数统计&#58;</span>
                
                <span title="字数统计">
                  792
                </span>
              

              
                <span class="post-meta-divider">|</span>
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-clock-o"></i>
                </span>
                
                  <span class="post-meta-item-text">阅读时长 &asymp;</span>
                
                <span title="阅读时长">
                  2
                </span>
              
            </div>
          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h3 id="设计原则之单一职责"><a href="#设计原则之单一职责" class="headerlink" title="设计原则之单一职责"></a>设计原则之单一职责</h3><p>—-逃梦</p>
<h2 id="定义"><a href="#定义" class="headerlink" title="定义"></a>定义</h2><p>&emsp;&emsp;单一职责原则。</p>
<p>&emsp;&emsp;英文全称：Simple Responsibility Principle。</p>
<p>&emsp;&emsp;简称：SRP</p>
<p>&emsp;&emsp;英文定义：There should never be more than on reason for a class to change.</p>
<p>&emsp;&emsp;中文解释：不要有多过一个引起类变更的原因。</p>
<h2 id="核心思想"><a href="#核心思想" class="headerlink" title="核心思想"></a>核心思想</h2><p>&emsp;&emsp;一个类只关心一个职责。</p>
<h2 id="好处"><a href="#好处" class="headerlink" title="好处"></a>好处</h2><ul>
<li>降低类、接口、方法的复杂性，明确定义相应职责；</li>
<li>提高可读性</li>
<li>提高扩展性</li>
<li>提高可维护性</li>
<li>降低变更引起的风险</li>
</ul>
<h2 id="难点"><a href="#难点" class="headerlink" title="难点"></a>难点</h2><ul>
<li>如何定义、划分职责</li>
</ul>
<h2 id="建议"><a href="#建议" class="headerlink" title="建议"></a>建议</h2><ul>
<li>在接口上一定要做到单一职责</li>
<li>在方法上一定要做到单一职责</li>
<li>在类上尽可能做到单一职责</li>
</ul>
<p>&emsp;&emsp;单一职责拆分时考虑：</p>
<ul>
<li>属性和行为可以考虑进行拆分；</li>
<li>行为间考察相互影响；</li>
<li>一个方法尽可能只做一件事情</li>
<li>类在拆分时要避免出现强关联情况，比如聚合、组合。</li>
</ul>
<h2 id="实践"><a href="#实践" class="headerlink" title="实践"></a>实践</h2><ul>
<li><p>属性和行为拆分</p>
<p>比如我们在系统开发过程中会涉及到用户管理模块。在用户信息中可能会包含如下操作：</p>
<ul>
<li>设置用户ID</li>
<li>获取用户ID</li>
<li>设置用户名称</li>
<li>获取用户名称</li>
<li>设置用户密码</li>
<li>获取用户密码</li>
<li>修改用户名称</li>
<li>修改用户密码</li>
<li>用户短信验证</li>
</ul>
<p>其类图如下：</p>
<p><img src="http://zhaozg.vip/Java/DesignPattern/Images/srp/1547226560754.png" alt="1547226560754"></p>
<p>&emsp;&emsp;在这个类图中，用户的属性和行为没有进行拆分，这个是违背单一职责原则的。在项目中依据单一职责重构后的类图为：</p>
<p><img src="http://zhaozg.vip/Java/DesignPattern/Images/srp/1547228299351.png" alt="1547228299351"></p>
</li>
<li><p>行为间的拆分</p>
<p>&emsp;&emsp;比如为定义了一个操作电脑的接口，包含了开机、关机、打字这样的方法。其类图如下：</p>
<p><img src="http://zhaozg.vip/Java/DesignPattern/Images/srp/1547228876793.png" alt="1547228876793"></p>
</li>
</ul>
<p>  &emsp;&emsp;但是实际上开机、关机的行为和打字的行为在职责上的变化并不会互相影响。所以这种行为之间是可以使用单一职责原则的。对接口拆分，并分别定义其实现类，再组合成Computer类。其类图如下：</p>
<p>  <img src="http://zhaozg.vip/Java/DesignPattern/Images/srp/1547229448879.png" alt="1547229448879"></p>
<p>  &emsp;&emsp;在这样的操作下，是符合单一职责原则的，但是Computer类需要将ComputerControl和ComputerOption组合在一起才能使用，这种情况，增加了类之间的耦合关系，同时增加了类的复杂性，在项目中我们通常调整为如下情况：</p>
<p>  <img src="http://zhaozg.vip/Java/DesignPattern/Images/srp/1547229693614.png" alt="1547229693614"></p>
<ul>
<li><p>方法间的拆分</p>
<p>比如如下方法：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setUserInfo</span><span class="params">(String username,String password)</span></span></span><br><span class="line"><span class="function">	</span>&#123;</span><br><span class="line">		<span class="keyword">this</span>.UserName=username;</span><br><span class="line">		<span class="keyword">this</span>.Password=password;</span><br><span class="line">	&#125;</span><br></pre></td></tr></table></figure>
<p>建议拆分为：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setUserName</span><span class="params">(String username)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="keyword">this</span>.UserName=username;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setPassword</span><span class="params">(String password)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="keyword">this</span>.Password=password;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
</ul>
<h2 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h2><p>&emsp;&emsp;单一职责原则是编写程序的标准，使用“职责”和“变更原因”来衡量接口、类、方法的设计是否优良，但是“职责”和“变更原因”又是无法量化的，在不同的项目，不同的环境中，标准也会不同。考虑到在实际项目中会受到项目工期、人员水平、业务需求熟悉度等条件的影响，会出现破坏单一职责的情况，此时，针对不同情况再分别对待吧。</p>

          
        
      
    </div>
    
    
    
    
    <div>
		  
		</div>
		
		<div>
      
		</div>

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
  </section>

  


          </div>
          


          

        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      

      <section class="site-overview-wrap sidebar-panel sidebar-panel-active">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope="" itemtype="http://schema.org/Person">
            
              <p class="site-author-name" itemprop="name">逃梦</p>
              <p class="site-description motion-element" itemprop="description">静，生命之完美；水，生命之本源；流，生命之体现；深，生命之蕴集.</p>
          </div>

          <nav class="site-state motion-element">

            
              <div class="site-state-item site-state-posts">
              
                <a href="/archives/">
              
                  <span class="site-state-item-count">10</span>
                  <span class="site-state-item-name">日志</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-categories">
                <a href="/categories/index.html">
                  <span class="site-state-item-count">3</span>
                  <span class="site-state-item-name">分类</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-tags">
                <a href="/tags/index.html">
                  <span class="site-state-item-count">3</span>
                  <span class="site-state-item-name">标签</span>
                </a>
              </div>
            

          </nav>

          
            <div class="feed-link motion-element">
              <a href="/atom.xml" rel="alternate">
                <i class="fa fa-rss"></i>
                RSS
              </a>
            </div>
          

          

          
          

          
          
					<div id="music163player">
						<iframe frameborder="no" border="0" marginwidth="0" marginheight="0" width="330" height="86" src="//music.163.com/outchain/player?type=2&id=194405&auto=1&height=66"></iframe>
					</div>
          

        </div>
      </section>

      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        ﻿<div class="copyright">&copy; <span itemprop="copyrightYear">2019</span>
  <span class="with-love">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">逃梦</span>
<!--
  
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item-icon">
      <i class="fa fa-area-chart"></i>
    </span>
    
      <span class="post-meta-item-text">Site words total count&#58;</span>
    
    <span title="Site words total count">14.7k</span>
  
  -->
</div>



  <div class="powered-by"></div>


<div> <script async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script> 本站总访问量 <span id="busuanzi_value_site_pv"></span> 次&nbsp&nbsp&nbsp 本站访客数<span id="busuanzi_value_site_uv"></span>人次 </div> 


  <div class="theme-info"></div>



        







        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  


  











  
  
    <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>
  

  
  
    <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>
  

  
  
    <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>
  

  
  
    <script type="text/javascript" src="/lib/canvas-nest/canvas-nest.min.js"></script>
  


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.4"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.4"></script>



  
  


  <script type="text/javascript" src="/js/src/affix.js?v=5.1.4"></script>

  <script type="text/javascript" src="/js/src/schemes/pisces.js?v=5.1.4"></script>



  

  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.4"></script>



  


  




	





  





  










  <script src="//cdn1.lncld.net/static/js/3.0.4/av-min.js"></script>
  <script src="//unpkg.com/valine/dist/Valine.min.js"></script>
  
  <script type="text/javascript">
    var GUEST = ['nick','mail','link'];
    var guest = 'nick,mail,link';
    guest = guest.split(',').filter(item=>{
      return GUEST.indexOf(item)>-1;
    });
    new Valine({
        el: '#comments' ,
        verify: false,
        notify: false,
        appId: 'HoXjaKwO8EeV9wdRoNLu9EpW-gzGzoHsz',
        appKey: '06xLodBKOXpQDvIEU0qdOsBd',
        placeholder: '说点什么呗！',
        avatar:'mm',
        guest_info:guest,
        pageSize:'10' || 10,
    });
  </script>



  





  

  

  
<script>
(function(){
    var bp = document.createElement('script');
    var curProtocol = window.location.protocol.split(':')[0];
    if (curProtocol === 'https') {
        bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';        
    }
    else {
        bp.src = 'http://push.zhanzhang.baidu.com/push.js';
    }
    var s = document.getElementsByTagName("script")[0];
    s.parentNode.insertBefore(bp, s);
})();
</script>


  
  

  

  

  

</body>
</html>
